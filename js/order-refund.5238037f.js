(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order-refund"],{"07ed":function(t,e,s){},"20d6":function(t,e,s){"use strict";var a=s("5ca1"),i=s("0a49")(6),r="findIndex",n=!0;r in[]&&Array(1)[r](function(){n=!1}),a(a.P+a.F*n,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),s("9c6c")(r)},"3d06":function(t,e,s){},"3d3e":function(t,e,s){},"3f0a":function(t,e,s){"use strict";var a=s("54e1"),i=s.n(a);i.a},4631:function(t,e,s){},"4d42":function(t,e,s){"use strict";var a=s("7f22"),i=s.n(a);i.a},"4d7e":function(t,e,s){"use strict";var a=s("3d3e"),i=s.n(a);i.a},"4d97":function(t,e,s){"use strict";var a=s("07ed"),i=s.n(a);i.a},"54e1":function(t,e,s){},"56ee":function(t,e,s){"use strict";var a=s("bff6"),i=s.n(a);i.a},"5df3":function(t,e,s){"use strict";var a=s("02f4")(!0);s("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,s=this._i;return s>=e.length?{value:void 0,done:!0}:(t=a(e,s),this._i+=t.length,{value:t,done:!1})})},"7f22":function(t,e,s){},"80bf":function(t,e,s){"use strict";s("96cf");var a=s("1da1"),i=(s("7f7f"),s("a3fb"));e["a"]=function(t){var e=t.name,s=t.components,r=t.map;return{name:e,components:s,data:function(){return{store:{}}},created:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["b"])();case 2:this.store=t.sent;case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),render:function(t){return t(r[this.store.kind])}}}},8430:function(t,e,s){},a68a:function(t,e,s){"use strict";var a=s("8430"),i=s.n(a);i.a},ab1c:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tab"},t._l(t.data,function(e){return s("div",{key:e.label,class:["tab-item",{active:t.value===e.value}],on:{click:function(s){t.onClickItem(e.value)}}},[t._v(t._s(e.label))])}))},i=[],r={props:{data:{type:Array,default:function(){return[{label:"test",value:0},{label:"test2",value:1}]},required:!0},value:{default:"",required:!0}},methods:{onClickItem:function(t){this.$emit("input",t)}}},n=r,l=(s("56ee"),s("2877")),o=Object(l["a"])(n,a,i,!1,null,"5e44c4ee",null);e["a"]=o.exports},bff6:function(t,e,s){},d2af:function(t,e,s){"use strict";var a=s("3d06"),i=s.n(a);i.a},e43d:function(t,e,s){"use strict";var a=s("4631"),i=s.n(a);i.a},f52f:function(t,e,s){"use strict";s.r(e);var a,i,r=s("80bf"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"container"},[s("el-form",{attrs:{"label-position":"left","label-width":"90px",size:"mini"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单号"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"买家手机号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入买家手机号"},model:{value:t.params.delivermobile,callback:function(e){t.$set(t.params,"delivermobile",e)},expression:"params.delivermobile"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单类型"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.ordertype,callback:function(e){t.$set(t.params,"ordertype",e)},expression:"params.ordertype"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"团购订单",value:1}})],1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"是否分销"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.isprofitsharing,callback:function(e){t.$set(t.params,"isprofitsharing",e)},expression:"params.isprofitsharing"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"非分销",value:1}}),s("el-option",{attrs:{label:"分销单",value:2}})],1)],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"下单时间"}},[s("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange","unlink-panels":""},model:{value:t.params.time,callback:function(e){t.$set(t.params,"time",e)},expression:"params.time"}})],1)],1)],1)],1),s("el-button",{attrs:{size:"small"},on:{click:t.onClickFilter}},[t._v("筛选")]),s("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.onClickClearFilter}},[t._v("清空筛选条件")])],1),s("div",{staticClass:"container"},[s("comp-tab",{attrs:{data:t.tabs},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),s("div",{staticClass:"container"},[t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"item"},[s("div",{staticClass:"order-detail"},[s("div",[s("span",{staticClass:"order-detail_text"},[t._v(t._s(e.id))]),e.groupuuid?s("span",{staticClass:"invoice m10"},[t._v(t._s("拼团 ID: "+e.groupuuid+" "+(2===e.grouplead?"团长代收":"单独发货")))]):t._e(),e.needinvoice?s("span",{staticClass:"invoice m10"},[t._v("需要开发票")]):t._e()]),s("div",[s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(e.user.nickname)+" "+t._s(e.user.mobile))]),2===e.user.isvip?s("span",{staticClass:"member-tag",staticStyle:{padding:"0 4px"}},[t._v("会员")]):t._e(),s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"})))]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("查看详情")])],1)]),s("div",{staticClass:"table"},[s("div",{staticClass:"products"},t._l(e.orderproductsList,function(e){return s("div",{key:e.id,staticClass:"product"},[s("div",{staticClass:"product-info"},[s("div",{staticClass:"product-img"},[s("comp-imger",{attrs:{src:e.product.imagesList.length?e.product.imagesList[0]:""}})],1),s("div",[s("div",{staticClass:"product-name"},[t._v(t._s(e.product.name))]),s("div",{staticClass:"product-desc"},[t._v(t._s(e.optionname&&"("+Object.values(JSON.parse(e.optionname)).join(", ")+")"))])])]),s("div",{staticClass:"price"},[t._v(t._s(t.$amount1(e.amount))+" 元")]),s("div",{staticClass:"count"},[t._v(t._s(e.quantity)+" 个")])])})),s("div",{staticClass:"action"},[s("span",{staticClass:"action-text"},[t._v(t._s(t.map[e.status]||"非此类型商城该有状态"))]),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,2)}}},[t._v("拒绝退款")]):t._e(),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("同意退款")]):t._e(),2==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,3)}}},[t._v("发货")]):t._e(),2==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("缺货直接退款")]):t._e()],1)]),s("el-dialog",{attrs:{visible:t.dialogFormVisible,title:"确认发货",width:"400px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[s("el-form",{attrs:{"label-width":"80px",size:"small"}},[s("el-form-item",{attrs:{label:"物流公司"}},[s("el-select",{attrs:{placeholder:"请选择物流公司"},model:{value:t.shipping.company,callback:function(e){t.$set(t.shipping,"company",e)},expression:"shipping.company"}},t._l(t.shiplist,function(t){return s("el-option",{key:t,attrs:{label:t,value:t}})}))],1),s("el-form-item",{attrs:{label:"物流单号"}},[s("el-input",{attrs:{placeholder:"请输入物流单号"},model:{value:t.shipping.number,callback:function(e){t.$set(t.shipping,"number",e)},expression:"shipping.number"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{disabled:!t.shipping.company||!t.shipping.number,type:"primary"},on:{click:t.updateOrderShipping}},[t._v("确 定")])],1)],1)],1)}),t.list.length?t._e():s("div",{staticClass:"list-nodata"},[s("div",{staticClass:"fs"},[t._v("暂无数据")])]),t.list.length?s("div",{staticClass:"table-bottom"},[t.hasMore?s("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getOrders}},[t._v("加载更多")]):s("p",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1):t._e()],2)])},l=[],o=(s("20d6"),s("7514"),s("5df3"),s("ac6a"),s("be94")),c=(s("96cf"),s("1da1")),d=s("ab1c"),u=s("e8e1"),p=s("8e44"),m=s("73cd"),h={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},v={0:"等待买家支付",1:"拼团中",2:"待发货",3:"等待买家收货",4:"买家已收货",5:"团购失败",6:"买家已取消订单",7:"退货中",8:"已退款",9:"买家申请退货",10:"拒绝买家退货",11:"同意退货但拒绝退款",12:"买家申请退款"},b={components:{"comp-tab":d["a"]},name:"order-list",watch:{"params.status":function(){this.list=[],this.getOrders()}},data:function(){return{tabs:[{label:"全部订单",value:-1},{label:"申请退款",value:12},{label:"申请退货",value:9},{label:"退货中",value:7},{label:"拒绝退货",value:10},{label:"同意退货但拒绝退款",value:11},{label:"已退款",value:8}],pickerOptions:h,dialogFormVisible:!1,list:[],params:{id:"",status:-1,statuslistList:[7,8,9,10,11,12],idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,isprofitsharing:0,ordertype:0,time:[]},shiplist:["商家自送","顺丰速运","中国邮政速递物流","圆通速递","中通快递","百世快递","承诺达特快","品骏物流","韵达快递"],shippingrow:null,shipping:{company:"",number:""},loadmore:!1,hasMore:!0,map:v}},created:function(){this.token=Object(m["e"])(),this.getOrders()},methods:{getOrders:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i,r,n,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.loadmore=!0,e=window,s=e.scrollY,this.params.createdatgreaterthan=0,this.params.createdatlessthan=0,2===this.params.time.length&&(this.params.createdatgreaterthan=parseInt(this.params.time[0].getTime()/1e3),this.params.createdatlessthan=parseInt(this.params.time[1].getTime()/1e3)),this.params.isgroup=0,0!=this.params.ordertype&&1==this.params.ordertype&&(this.params.isgroup=1),!this.params.delivermobile){t.next=12;break}return t.next=10,Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),mobile:this.params.delivermobile,count:1,order:0}));case 10:a=t.sent,this.params.userid=a.userlistList.length?a.userlistList[0].id:0;case 12:return this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,t.next=15,Object(p["a"])("StoreOrderService.GetOrderList",Object(u["a"])("OrderListQueryRequest",Object(o["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params)));case 15:if(i=t.sent,0!==i.orderlistList.length){t.next=20;break}return this.loadmore=!1,this.hasMore=!1,t.abrupt("return");case 20:return r=i.orderlistList.map(function(t){return t.userid}),n=[],i.orderlistList.forEach(function(t){t.orderproductsList.forEach(function(t){n.push(t.productid)})}),t.next=25,Promise.all([Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length,order:0})),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:n,sortby:1,sort:1,count:n.length}))]);case 25:l=t.sent,i.orderlistList.forEach(function(t){t.user=l[0].userlistList.find(function(e){return e.id===t.userid}),t.orderproductsList.forEach(function(t){t.product=l[1].productlistList.find(function(e){return e.id===t.productid})})}),this.list=this.list.concat(i.orderlistList),this.hasMore=i.orderlistList.length,this.loadmore=!1,0!==this.params.idlessthan&&window.scroll(0,s);case 31:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),updateOrder:function(t,e){var s=this;if(t=JSON.parse(JSON.stringify(t)),3==e)return this.shippingrow=t,void(this.dialogFormVisible=!0);t.status=e,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},t,{address:Object(u["a"])("Address",t.address),invoice:Object(u["a"])("Invoice",t.invoice),orderproductsList:t.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(e){s.list.splice(s.list.findIndex(function(t){return t.id===e.id}),1,t),s.$message({message:"操作成功",type:"success"})})},updateOrderShipping:function(){var t=this,e=JSON.parse(JSON.stringify(this.shippingrow));e.status=3,e.shippingcompany=this.shipping.company,e.shippingnumber=this.shipping.number,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},e,{address:Object(u["a"])("Address",e.address),invoice:Object(u["a"])("Invoice",e.invoice),orderproductsList:e.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(s){t.list.splice(t.list.findIndex(function(t){return t.id===s.id}),1,e),t.$message({message:"操作成功",type:"success"})})},onClickFilter:function(){this.list=[],this.getOrders()},onClickClearFilter:function(){this.params={id:"",status:-1,statuslistList:null,idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,ordertype:0,time:[]},this.list=[],this.getOrders()}}},f=b,k=(s("e43d"),s("2877")),g=Object(k["a"])(f,n,l,!1,null,"7a2d2d9e",null),_=g.exports,O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"container"},[s("el-form",{attrs:{"label-position":"left","label-width":"90px",size:"mini"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单号"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"买家手机号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入买家手机号"},model:{value:t.params.delivermobile,callback:function(e){t.$set(t.params,"delivermobile",e)},expression:"params.delivermobile"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单类型"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.ordertype,callback:function(e){t.$set(t.params,"ordertype",e)},expression:"params.ordertype"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"团购订单",value:1}})],1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"是否分销"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.isprofitsharing,callback:function(e){t.$set(t.params,"isprofitsharing",e)},expression:"params.isprofitsharing"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"非分销",value:1}}),s("el-option",{attrs:{label:"分销单",value:2}})],1)],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"下单时间"}},[s("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange","unlink-panels":""},model:{value:t.params.time,callback:function(e){t.$set(t.params,"time",e)},expression:"params.time"}})],1)],1)],1)],1),s("el-button",{attrs:{size:"small"},on:{click:t.onClickFilter}},[t._v("筛选")]),s("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.onClickClearFilter}},[t._v("清空筛选条件")])],1),s("div",{staticClass:"container"},[s("comp-tab",{attrs:{data:t.tabs},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),s("div",{staticClass:"container"},[t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"item"},[s("div",{staticClass:"order-detail"},[s("div",[s("span",{staticClass:"order-detail_text"},[t._v(t._s(e.id))]),e.groupuuid?s("span",{staticClass:"invoice m10"},[t._v(t._s("拼团 ID: "+e.groupuuid))]):t._e(),e.needinvoice?s("span",{staticClass:"invoice m10"},[t._v("需要开发票")]):t._e()]),s("div",[s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(e.user.nickname)+" "+t._s(e.user.mobile))]),2===e.user.isvip?s("span",{staticClass:"member-tag",staticStyle:{padding:"0 4px"}},[t._v("会员")]):t._e(),s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"})))]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("查看详情")])],1)]),s("div",{staticClass:"table"},[s("div",{staticClass:"products"},t._l(e.orderproductsList,function(a){return s("div",{key:a.id,staticClass:"product"},[s("div",{staticClass:"product-info"},[s("div",{staticClass:"product-img"},[s("comp-imger",{attrs:{src:a.product.imagesList.length?a.product.imagesList[0]:""}})],1),s("div",[s("div",{staticClass:"product-name"},[t._v(t._s(a.product.name))]),s("div",{staticClass:"product-desc"},[t._v(t._s(a.optionname&&"("+Object.values(JSON.parse(a.optionname)).join(", ")+")"))])])]),s("div",{staticClass:"price"},[t._v(t._s(t.$amount1(a.amount))+" 元")]),s("div",{staticClass:"count"},[t._v(t._s(a.quantity)+" 个")]),2==e.status?s("div",{staticClass:"count"},[1==a.confirmed?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrderProduct(e,a,2)}}},[t._v("核销")]):t._e(),2==a.confirmed?s("span",{staticClass:"action-text"},[t._v("已核销")]):t._e()],1):t._e(),2!=e.status?s("div",{staticClass:"count"},[s("span",{staticClass:"action-text"},[t._v("/")])]):t._e()])})),s("div",{staticClass:"action"},[s("span",{staticClass:"action-text"},[t._v(t._s(t.map[e.status]||"非此类型商城该有状态"))]),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,2)}}},[t._v("拒绝退款")]):t._e(),2==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,3)}}},[t._v("全部核销")]):t._e(),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("同意退款")]):t._e(),2!=e.status||e.orderproductsList.find(function(t){return 2==t.confirmed})?t._e():s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("无法提供服务直接退款")])],1)])])}),t.list.length?t._e():s("div",{staticClass:"list-nodata"},[s("div",{staticClass:"fs"},[t._v("暂无数据")])]),t.list.length?s("div",{staticClass:"table-bottom"},[t.hasMore?s("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getOrders}},[t._v("加载更多")]):s("p",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1):t._e()],2)])},y=[],C={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},x={0:"等待买家支付",1:"拼团中",2:"待核销",4:"已核销",5:"团购失败",6:"买家已取消订单",8:"已退款",12:"买家申请退款"},L={components:{"comp-tab":d["a"]},name:"order-list",watch:{"params.status":function(){this.list=[],this.getOrders()}},data:function(){return{tabs:[{label:"全部订单",value:-1},{label:"申请退款",value:12},{label:"已退款",value:8}],pickerOptions:C,dialogFormVisible:!1,list:[],params:{id:"",status:-1,statuslistList:[12,8],idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,isprofitsharing:0,ordertype:0,time:[]},loadmore:!1,hasMore:!0,map:x}},created:function(){this.token=Object(m["e"])(),this.getOrders()},methods:{getOrders:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i,r,n,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.loadmore=!0,e=window,s=e.scrollY,this.params.createdatgreaterthan=0,this.params.createdatlessthan=0,2===this.params.time.length&&(this.params.createdatgreaterthan=parseInt(this.params.time[0].getTime()/1e3),this.params.createdatlessthan=parseInt(this.params.time[1].getTime()/1e3)),this.params.isgroup=0,0!=this.params.ordertype&&1==this.params.ordertype&&(this.params.isgroup=1),!this.params.delivermobile){t.next=12;break}return t.next=10,Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),mobile:this.params.delivermobile,count:1,order:0}));case 10:a=t.sent,this.params.userid=a.userlistList.length?a.userlistList[0].id:0;case 12:return this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,t.next=15,Object(p["a"])("StoreOrderService.GetOrderList",Object(u["a"])("OrderListQueryRequest",Object(o["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params)));case 15:if(i=t.sent,0!==i.orderlistList.length){t.next=20;break}return this.loadmore=!1,this.hasMore=!1,t.abrupt("return");case 20:return r=i.orderlistList.map(function(t){return t.userid}),n=[],i.orderlistList.forEach(function(t){t.orderproductsList.forEach(function(t){n.push(t.productid)})}),t.next=25,Promise.all([Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length,order:0})),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:n,sortby:1,sort:1,count:n.length}))]);case 25:l=t.sent,i.orderlistList.forEach(function(t){t.user=l[0].userlistList.find(function(e){return e.id===t.userid}),t.orderproductsList.forEach(function(t){t.product=l[1].productlistList.find(function(e){return e.id===t.productid})})}),this.list=this.list.concat(i.orderlistList),this.hasMore=i.orderlistList.length,this.loadmore=!1,0!==this.params.idlessthan&&window.scroll(0,s);case 31:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),updateOrder:function(t,e){var s=this;t=JSON.parse(JSON.stringify(t)),t.status=e,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},t,{address:Object(u["a"])("Address",t.address),invoice:Object(u["a"])("Invoice",t.invoice),orderproductsList:t.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(e){s.list.splice(s.list.findIndex(function(t){return t.id===e.id}),1,t),s.$message({message:"操作成功",type:"success"})})},updateOrderProduct:function(t,e,s){var a=this;e=JSON.parse(JSON.stringify(e)),e.confirmed=s,Object(p["a"])("StoreOrderService.UpdateOrderProduct",Object(u["a"])("OrderProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),orderproduct:Object(u["a"])("OrderProduct",e)})).then(function(s){console.log(s),e.updatedat=s.updatedat;var i=a.list.findIndex(function(e){return e.id===t.id}),r=a.list[i].orderproductsList.findIndex(function(t){return t.id===e.id});a.list[i].orderproductsList.splice(r,1,e),a.list[i].orderproductsList.find(function(t){return 2!=t.confirmed})||(a.list[i].status=4,a.list[i].updatedat=s.updatedat),a.$message({message:"操作成功",type:"success"})})},onClickFilter:function(){this.list=[],this.getOrders()},onClickClearFilter:function(){this.params={id:"",status:-1,statuslistList:null,idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,ordertype:0,time:[]},this.list=[],this.getOrders()}}},j=L,w=(s("4d97"),Object(k["a"])(j,O,y,!1,null,"283cb555",null)),S=w.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"container"},[s("el-form",{attrs:{"label-position":"left","label-width":"90px",size:"mini"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单号"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"买家手机号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入买家手机号"},model:{value:t.params.delivermobile,callback:function(e){t.$set(t.params,"delivermobile",e)},expression:"params.delivermobile"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单类型"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.ordertype,callback:function(e){t.$set(t.params,"ordertype",e)},expression:"params.ordertype"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"团购订单",value:1}})],1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"是否分销"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.isprofitsharing,callback:function(e){t.$set(t.params,"isprofitsharing",e)},expression:"params.isprofitsharing"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"非分销",value:1}}),s("el-option",{attrs:{label:"分销单",value:2}})],1)],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"下单时间"}},[s("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange","unlink-panels":""},model:{value:t.params.time,callback:function(e){t.$set(t.params,"time",e)},expression:"params.time"}})],1)],1)],1)],1),s("el-button",{attrs:{size:"small"},on:{click:t.onClickFilter}},[t._v("筛选")]),s("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.onClickClearFilter}},[t._v("清空筛选条件")])],1),s("div",{staticClass:"container"},[s("comp-tab",{attrs:{data:t.tabs},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),s("div",{staticClass:"container"},[t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"item"},[s("div",{staticClass:"order-detail"},[s("div",[s("span",{staticClass:"order-detail_text"},[t._v(t._s(e.id))]),e.groupuuid?s("span",{staticClass:"invoice m10"},[t._v(t._s("拼团 ID: "+e.groupuuid+" "+(2===e.grouplead?"团长代收":"单独发货")))]):t._e(),e.needinvoice?s("span",{staticClass:"invoice m10"},[t._v("需要开发票")]):t._e()]),s("div",[s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(e.user.nickname)+" "+t._s(e.user.mobile))]),2===e.user.isvip?s("span",{staticClass:"member-tag",staticStyle:{padding:"0 4px"}},[t._v("会员")]):t._e(),s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"})))]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("查看详情")])],1)]),s("div",{staticClass:"table"},[s("div",{staticClass:"products"},t._l(e.orderproductsList,function(e){return s("div",{key:e.id,staticClass:"product"},[s("div",{staticClass:"product-info"},[s("div",{staticClass:"product-img"},[s("comp-imger",{attrs:{src:e.product.imagesList.length?e.product.imagesList[0]:""}})],1),s("div",[s("div",{staticClass:"product-name"},[t._v(t._s(e.product.name))]),s("div",{staticClass:"product-desc"},[t._v(t._s(e.optionname&&"("+Object.values(JSON.parse(e.optionname)).join(", ")+")"))])])]),s("div",{staticClass:"price"},[t._v(t._s(t.$amount1(e.amount))+" 元")]),s("div",{staticClass:"count"},[t._v(t._s(e.quantity)+" 个")])])})),s("div",{staticClass:"action"},[s("span",{staticClass:"action-text"},[t._v(t._s(t.map[e.status]||"非此类型商城该有状态"))]),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,2)}}},[t._v("拒绝退款")]):t._e(),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("同意退款")]):t._e(),2==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,3)}}},[t._v("发货")]):t._e(),2==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("缺货直接退款")]):t._e()],1)]),s("el-dialog",{attrs:{visible:t.dialogFormVisible,title:"确认发货",width:"400px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[s("el-form",{attrs:{"label-width":"80px",size:"small"}},[s("el-form-item",{attrs:{label:"物流公司"}},[s("el-select",{attrs:{placeholder:"请选择物流公司"},model:{value:t.shipping.company,callback:function(e){t.$set(t.shipping,"company",e)},expression:"shipping.company"}},t._l(t.shiplist,function(t){return s("el-option",{key:t,attrs:{label:t,value:t}})}))],1),s("el-form-item",{attrs:{label:"物流单号"}},[s("el-input",{attrs:{placeholder:"请输入物流单号"},model:{value:t.shipping.number,callback:function(e){t.$set(t.shipping,"number",e)},expression:"shipping.number"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{disabled:!t.shipping.company||!t.shipping.number,type:"primary"},on:{click:t.updateOrderShipping}},[t._v("确 定")])],1)],1)],1)}),t.list.length?t._e():s("div",{staticClass:"list-nodata"},[s("div",{staticClass:"fs"},[t._v("暂无数据")])]),t.list.length?s("div",{staticClass:"table-bottom"},[t.hasMore?s("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getOrders}},[t._v("加载更多")]):s("p",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1):t._e()],2)])},$=[],z={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},q={0:"等待买家支付",1:"拼团中",2:"待发货",3:"等待买家收货",4:"买家已收货",5:"团购失败",6:"买家已取消订单",7:"退货中",8:"已退款",9:"买家申请退货",10:"拒绝买家退货",11:"同意退货但拒绝退款",12:"买家申请退款"},P={components:{"comp-tab":d["a"]},name:"order-list",watch:{"params.status":function(){this.list=[],this.getOrders()}},data:function(){return{tabs:[{label:"全部订单",value:-1},{label:"申请退款",value:12},{label:"申请退货",value:9},{label:"退货中",value:7},{label:"拒绝退货",value:10},{label:"同意退货但拒绝退款",value:11},{label:"已退款",value:8}],pickerOptions:z,dialogFormVisible:!1,list:[],params:{id:"",status:-1,statuslistList:[7,8,9,10,11,12],idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,isprofitsharing:0,ordertype:0,time:[]},shiplist:["商家自送","顺丰速运","中国邮政速递物流","圆通速递","中通快递","百世快递","承诺达特快","品骏物流","韵达快递"],shippingrow:null,shipping:{company:"",number:""},loadmore:!1,hasMore:!0,map:q}},created:function(){this.token=Object(m["e"])(),this.getOrders()},methods:{getOrders:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i,r,n,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.loadmore=!0,e=window,s=e.scrollY,this.params.createdatgreaterthan=0,this.params.createdatlessthan=0,2===this.params.time.length&&(this.params.createdatgreaterthan=parseInt(this.params.time[0].getTime()/1e3),this.params.createdatlessthan=parseInt(this.params.time[1].getTime()/1e3)),this.params.isgroup=0,0!=this.params.ordertype&&1==this.params.ordertype&&(this.params.isgroup=1),!this.params.delivermobile){t.next=12;break}return t.next=10,Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),mobile:this.params.delivermobile,count:1,order:0}));case 10:a=t.sent,this.params.userid=a.userlistList.length?a.userlistList[0].id:0;case 12:return this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,t.next=15,Object(p["a"])("StoreOrderService.GetOrderList",Object(u["a"])("OrderListQueryRequest",Object(o["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params)));case 15:if(i=t.sent,0!==i.orderlistList.length){t.next=20;break}return this.loadmore=!1,this.hasMore=!1,t.abrupt("return");case 20:return r=i.orderlistList.map(function(t){return t.userid}),n=[],i.orderlistList.forEach(function(t){t.orderproductsList.forEach(function(t){n.push(t.productid)})}),t.next=25,Promise.all([Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length,order:0})),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:n,sortby:1,sort:1,count:n.length}))]);case 25:l=t.sent,i.orderlistList.forEach(function(t){t.user=l[0].userlistList.find(function(e){return e.id===t.userid}),t.orderproductsList.forEach(function(t){t.product=l[1].productlistList.find(function(e){return e.id===t.productid})})}),this.list=this.list.concat(i.orderlistList),this.hasMore=i.orderlistList.length,this.loadmore=!1,0!==this.params.idlessthan&&window.scroll(0,s);case 31:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),updateOrder:function(t,e){var s=this;if(t=JSON.parse(JSON.stringify(t)),3==e)return this.shippingrow=t,void(this.dialogFormVisible=!0);t.status=e,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},t,{address:Object(u["a"])("Address",t.address),invoice:Object(u["a"])("Invoice",t.invoice),orderproductsList:t.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(e){s.list.splice(s.list.findIndex(function(t){return t.id===e.id}),1,t),s.$message({message:"操作成功",type:"success"})})},updateOrderShipping:function(){var t=this,e=JSON.parse(JSON.stringify(this.shippingrow));e.status=3,e.shippingcompany=this.shipping.company,e.shippingnumber=this.shipping.number,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},e,{address:Object(u["a"])("Address",e.address),invoice:Object(u["a"])("Invoice",e.invoice),orderproductsList:e.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(s){t.list.splice(t.list.findIndex(function(t){return t.id===s.id}),1,e),t.$message({message:"操作成功",type:"success"})})},onClickFilter:function(){this.list=[],this.getOrders()},onClickClearFilter:function(){this.params={id:"",status:-1,statuslistList:null,idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,ordertype:0,time:[]},this.list=[],this.getOrders()}}},R=P,D=(s("4d7e"),Object(k["a"])(R,T,$,!1,null,"d25c169a",null)),U=D.exports,E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"container"},[s("el-form",{attrs:{"label-position":"left","label-width":"90px",size:"mini"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单号"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"买家手机号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入买家手机号"},model:{value:t.params.delivermobile,callback:function(e){t.$set(t.params,"delivermobile",e)},expression:"params.delivermobile"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单类型"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.ordertype,callback:function(e){t.$set(t.params,"ordertype",e)},expression:"params.ordertype"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"团购订单",value:1}})],1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"是否分销"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.isprofitsharing,callback:function(e){t.$set(t.params,"isprofitsharing",e)},expression:"params.isprofitsharing"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"非分销",value:1}}),s("el-option",{attrs:{label:"分销单",value:2}})],1)],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"下单时间"}},[s("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange","unlink-panels":""},model:{value:t.params.time,callback:function(e){t.$set(t.params,"time",e)},expression:"params.time"}})],1)],1)],1)],1),s("el-button",{attrs:{size:"small"},on:{click:t.onClickFilter}},[t._v("筛选")]),s("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.onClickClearFilter}},[t._v("清空筛选条件")])],1),s("div",{staticClass:"container"},[s("comp-tab",{attrs:{data:t.tabs},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),s("div",{staticClass:"container"},[t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"item"},[s("div",{staticClass:"order-detail"},[s("div",[s("span",{staticClass:"order-detail_text"},[t._v(t._s(e.id))]),e.groupuuid?s("span",{staticClass:"invoice m10"},[t._v(t._s("拼团 ID: "+e.groupuuid))]):t._e(),e.needinvoice?s("span",{staticClass:"invoice m10"},[t._v("需要开发票")]):t._e()]),s("div",[s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(e.user.nickname)+" "+t._s(e.user.mobile))]),2===e.user.isvip?s("span",{staticClass:"member-tag",staticStyle:{padding:"0 4px"}},[t._v("会员")]):t._e(),s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"})))]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("查看详情")])],1)]),s("div",{staticClass:"table"},[s("div",{staticClass:"products"},t._l(e.orderproductsList,function(a){return s("div",{key:a.id,staticClass:"product"},[s("div",{staticClass:"product-info"},[s("div",{staticClass:"product-img"},[s("comp-imger",{attrs:{src:a.product.imagesList.length?a.product.imagesList[0]:""}})],1),s("div",[s("div",{staticClass:"product-name"},[t._v(t._s(a.product.name))]),s("div",{staticClass:"product-desc"},[t._v(t._s(t.week[a.week])+" "+t._s(a.duration/60/60)+"小时 ("+t._s(a.begintime)+" - "+t._s(a.endtime.startsWith(":")?"次日"+a.endtime.slice(1):a.endtime)+")")])])]),s("div",{staticClass:"price"},[t._v(t._s(t.$amount1(a.amount))+" 元")]),s("div",{staticClass:"count"},[t._v(t._s(a.quantity)+" 个")]),2==e.status?s("div",{staticClass:"count"},[1==a.confirmed?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrderProduct(e,a,2)}}},[t._v("核销")]):t._e(),2==a.confirmed?s("span",{staticClass:"action-text"},[t._v("已核销")]):t._e()],1):t._e(),2!=e.status?s("div",{staticClass:"count"},[s("span",{staticClass:"action-text"},[t._v("/")])]):t._e()])})),s("div",{staticClass:"action"},[s("span",{staticClass:"action-text"},[t._v(t._s(t.map[e.status]||"非此类型商城该有状态"))]),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,2)}}},[t._v("拒绝退款")]):t._e(),2==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,3)}}},[t._v("全部核销")]):t._e(),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("同意退款")]):t._e(),2!=e.status||e.orderproductsList.find(function(t){return 2==t.confirmed})?t._e():s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("无法提供服务直接退款")])],1)])])}),t.list.length?t._e():s("div",{staticClass:"list-nodata"},[s("div",{staticClass:"fs"},[t._v("暂无数据")])]),t.list.length?s("div",{staticClass:"table-bottom"},[t.hasMore?s("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getOrders}},[t._v("加载更多")]):s("p",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1):t._e()],2)])},I=[],F={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},N={0:"等待买家支付",1:"拼团中",2:"待核销",4:"已核销",5:"团购失败",6:"买家已取消订单",8:"已退款",12:"买家申请退款"},G={components:{"comp-tab":d["a"]},name:"order-list",watch:{"params.status":function(){this.list=[],this.getOrders()}},data:function(){return{tabs:[{label:"全部订单",value:-1},{label:"申请退款",value:12},{label:"已退款",value:8}],pickerOptions:F,dialogFormVisible:!1,list:[],params:{id:"",status:-1,statuslistList:[12,8],idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,isprofitsharing:0,ordertype:0,time:[]},loadmore:!1,hasMore:!0,map:N}},created:function(){this.token=Object(m["e"])(),this.getOrders()},methods:{getOrders:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i,r,n,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.loadmore=!0,e=window,s=e.scrollY,this.params.createdatgreaterthan=0,this.params.createdatlessthan=0,2===this.params.time.length&&(this.params.createdatgreaterthan=parseInt(this.params.time[0].getTime()/1e3),this.params.createdatlessthan=parseInt(this.params.time[1].getTime()/1e3)),this.params.isgroup=0,0!=this.params.ordertype&&1==this.params.ordertype&&(this.params.isgroup=1),!this.params.delivermobile){t.next=12;break}return t.next=10,Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),mobile:this.params.delivermobile,count:1,order:0}));case 10:a=t.sent,this.params.userid=a.userlistList.length?a.userlistList[0].id:0;case 12:return this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,t.next=15,Object(p["a"])("StoreOrderService.GetOrderList",Object(u["a"])("OrderListQueryRequest",Object(o["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params)));case 15:if(i=t.sent,0!==i.orderlistList.length){t.next=20;break}return this.loadmore=!1,this.hasMore=!1,t.abrupt("return");case 20:return r=i.orderlistList.map(function(t){return t.userid}),n=[],i.orderlistList.forEach(function(t){t.orderproductsList.forEach(function(t){n.push(t.productid)})}),t.next=25,Promise.all([Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length,order:0})),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:n,sortby:1,sort:1,count:n.length}))]);case 25:l=t.sent,i.orderlistList.forEach(function(t){t.user=l[0].userlistList.find(function(e){return e.id===t.userid}),t.orderproductsList.forEach(function(t){t.product=l[1].productlistList.find(function(e){return e.id===t.productid})})}),this.list=this.list.concat(i.orderlistList),this.hasMore=i.orderlistList.length,this.loadmore=!1,0!==this.params.idlessthan&&window.scroll(0,s);case 31:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),updateOrder:function(t,e){var s=this;t=JSON.parse(JSON.stringify(t)),t.status=e,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},t,{address:Object(u["a"])("Address",t.address),invoice:Object(u["a"])("Invoice",t.invoice),orderproductsList:t.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(e){s.list.splice(s.list.findIndex(function(t){return t.id===e.id}),1,t),s.$message({message:"操作成功",type:"success"})})},updateOrderProduct:function(t,e,s){var a=this;e=JSON.parse(JSON.stringify(e)),e.confirmed=s,Object(p["a"])("StoreOrderService.UpdateOrderProduct",Object(u["a"])("OrderProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),orderproduct:Object(u["a"])("OrderProduct",e)})).then(function(s){console.log(s),e.updatedat=s.updatedat;var i=a.list.findIndex(function(e){return e.id===t.id}),r=a.list[i].orderproductsList.findIndex(function(t){return t.id===e.id});a.list[i].orderproductsList.splice(r,1,e),a.list[i].orderproductsList.find(function(t){return 2!=t.confirmed})||(a.list[i].status=4,a.list[i].updatedat=s.updatedat),a.$message({message:"操作成功",type:"success"})})},onClickFilter:function(){this.list=[],this.getOrders()},onClickClearFilter:function(){this.params={id:"",status:-1,statuslistList:null,idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,ordertype:0,time:[]},this.list=[],this.getOrders()}}},J=G,M=(s("4d42"),Object(k["a"])(J,E,I,!1,null,"c4926ffc",null)),Q=M.exports,A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"container"},[s("el-form",{attrs:{"label-position":"left","label-width":"90px",size:"mini"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单号"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"买家手机号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入买家手机号"},model:{value:t.params.delivermobile,callback:function(e){t.$set(t.params,"delivermobile",e)},expression:"params.delivermobile"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单类型"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.ordertype,callback:function(e){t.$set(t.params,"ordertype",e)},expression:"params.ordertype"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"团购订单",value:1}}),s("el-option",{attrs:{label:"周期购订单",value:2}})],1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"是否分销"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.isprofitsharing,callback:function(e){t.$set(t.params,"isprofitsharing",e)},expression:"params.isprofitsharing"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"非分销",value:1}}),s("el-option",{attrs:{label:"分销单",value:2}})],1)],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"下单时间"}},[s("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange","unlink-panels":""},model:{value:t.params.time,callback:function(e){t.$set(t.params,"time",e)},expression:"params.time"}})],1)],1)],1)],1),s("el-button",{attrs:{size:"small"},on:{click:t.onClickFilter}},[t._v("筛选")]),s("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.onClickClearFilter}},[t._v("清空筛选条件")])],1),s("div",{staticClass:"container"},[s("comp-tab",{attrs:{data:t.tabs},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),s("div",{staticClass:"container"},[t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"item"},[s("div",{staticClass:"order-detail"},[s("div",[s("span",{staticClass:"order-detail_text"},[t._v(t._s(e.id))]),e.groupuuid?s("span",{staticClass:"invoice m10"},[t._v(t._s("拼团 ID: "+e.groupuuid+" "+(2===e.grouplead?"团长代收":"单独发货")))]):t._e(),e.needinvoice?s("span",{staticClass:"invoice m10"},[t._v("需要开发票")]):t._e(),e.subscriptionid>0?s("span",{staticClass:"invoice m10"},[t._v("周期购")]):t._e()]),s("div",[s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(e.user.nickname)+" "+t._s(e.user.mobile))]),2===e.user.isvip?s("span",{staticClass:"member-tag",staticStyle:{padding:"0 4px"}},[t._v("会员")]):t._e(),s("span",{staticClass:"order-detail_text m10"},[t._v(t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"})))]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("查看详情")])],1)]),s("div",{staticClass:"table"},[s("div",{staticClass:"products"},t._l(e.orderproductsList,function(a,i){return s("div",{key:a.id,staticClass:"product"},[s("div",{staticClass:"product-info"},[s("div",{staticClass:"product-img"},[s("comp-imger",{attrs:{src:a.product.imagesList.length?a.product.imagesList[0]:""}})],1),s("div",[s("div",{staticClass:"product-name"},[t._v(t._s(a.product.name))]),s("div",{staticClass:"product-desc"},[t._v(t._s(a.optionname&&"("+Object.values(JSON.parse(a.optionname)).join(", ")+")"))]),e.subscriptionid>0?s("div",{staticClass:"product-desc"},[t._v("第"+t._s(i+1)+"期 送达时间: "+t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"})))]):t._e()])]),s("div",{staticClass:"price"},[t._v(t._s(t.$amount1(a.amount))+" 元")]),s("div",{staticClass:"count"},[t._v(t._s(a.quantity)+" 个")])])})),s("div",{staticClass:"action"},[s("span",{staticClass:"action-text"},[t._v(t._s(t.map[e.status]||"非此类型商城该有状态"))]),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,2)}}},[t._v("拒绝退款")]):t._e(),12==e.status?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("同意退款")]):t._e(),2==e.status&&0==e.subscriptionid?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,3)}}},[t._v("发货")]):t._e(),2==e.status&&e.subscriptionid>0?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("发货")]):t._e(),2!=e.status||e.orderproductsList.find(function(t){return 2==t.confirmed})?t._e():s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.updateOrder(e,8)}}},[t._v("缺货直接退款")])],1)])])}),t.list.length?t._e():s("div",{staticClass:"list-nodata"},[s("div",{staticClass:"fs"},[t._v("暂无数据")])]),t.list.length?s("div",{staticClass:"table-bottom"},[t.hasMore?s("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getOrders}},[t._v("加载更多")]):s("p",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1):t._e()],2)])},V=[],W={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},Z={0:"等待买家支付",1:"拼团中",2:"待发货",3:"等待买家收货",4:"买家已收货",5:"团购失败",6:"买家已取消订单",8:"已退款",12:"买家申请退款"},Y={components:{"comp-tab":d["a"]},name:"order-list",watch:{"params.status":function(){this.list=[],this.getOrders()}},data:function(){return{tabs:[{label:"全部订单",value:-1},{label:"申请退款",value:12},{label:"已退款",value:8}],pickerOptions:W,dialogFormVisible:!1,list:[],params:{id:"",status:-1,statuslistList:[12,8],idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,isprofitsharing:0,ordertype:0,time:[]},loadmore:!1,hasMore:!0,map:Z}},created:function(){this.token=Object(m["e"])(),this.getOrders()},methods:{getOrders:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i,r,n,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.loadmore=!0,e=window,s=e.scrollY,this.params.createdatgreaterthan=0,this.params.createdatlessthan=0,2===this.params.time.length&&(this.params.createdatgreaterthan=parseInt(this.params.time[0].getTime()/1e3),this.params.createdatlessthan=parseInt(this.params.time[1].getTime()/1e3)),this.params.isgroup=0,this.params.issubscription=0,0!=this.params.ordertype&&(1==this.params.ordertype&&(this.params.isgroup=1),2==this.params.ordertype&&(this.params.issubscription=2)),!this.params.delivermobile){t.next=13;break}return t.next=11,Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),mobile:this.params.delivermobile,count:1,order:0}));case 11:a=t.sent,this.params.userid=a.userlistList.length?a.userlistList[0].id:0;case 13:return this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,t.next=16,Object(p["a"])("StoreOrderService.GetOrderList",Object(u["a"])("OrderListQueryRequest",Object(o["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params)));case 16:if(i=t.sent,0!==i.orderlistList.length){t.next=21;break}return this.loadmore=!1,this.hasMore=!1,t.abrupt("return");case 21:return r=i.orderlistList.map(function(t){return t.userid}),n=[],i.orderlistList.forEach(function(t){t.orderproductsList.forEach(function(t){n.push(t.productid)})}),t.next=26,Promise.all([Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length,order:0})),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:n,sortby:1,sort:1,count:n.length}))]);case 26:l=t.sent,i.orderlistList.forEach(function(t){t.user=l[0].userlistList.find(function(e){return e.id===t.userid}),t.orderproductsList.forEach(function(t){t.product=l[1].productlistList.find(function(e){return e.id===t.productid})})}),this.list=this.list.concat(i.orderlistList),this.hasMore=i.orderlistList.length,this.loadmore=!1,0!==this.params.idlessthan&&window.scroll(0,s);case 32:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),updateOrder:function(t,e){var s=this;t=JSON.parse(JSON.stringify(t)),t.status=e,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},t,{address:Object(u["a"])("Address",t.address),invoice:Object(u["a"])("Invoice",t.invoice),orderproductsList:t.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(e){s.list.splice(s.list.findIndex(function(t){return t.id===e.id}),1,t),s.$message({message:"操作成功",type:"success"})})},onClickFilter:function(){this.list=[],this.getOrders()},onClickClearFilter:function(){this.params={id:"",status:-1,statuslistList:null,idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isgroup:0,issubscription:0,ordertype:0,time:[]},this.list=[],this.getOrders()}}},B=Y,H=(s("d2af"),Object(k["a"])(B,A,V,!1,null,"3174ebd0",null)),K=H.exports,X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"container"},[s("el-form",{attrs:{"label-position":"right","label-width":"100px",size:"mini"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单号"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"外卖号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入外卖号"},model:{value:t.params.daynumber,callback:function(e){t.$set(t.params,"daynumber",e)},expression:"params.daynumber"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单类型"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.deliverkind,callback:function(e){t.$set(t.params,"deliverkind",e)},expression:"params.deliverkind"}},t._l(t.deliverkinds,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"下单人手机号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入下单人手机号"},model:{value:t.params.delivermobile,callback:function(e){t.$set(t.params,"delivermobile",e)},expression:"params.delivermobile"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"是否分销"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.isprofitsharing,callback:function(e){t.$set(t.params,"isprofitsharing",e)},expression:"params.isprofitsharing"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"非分销",value:1}}),s("el-option",{attrs:{label:"分销单",value:2}})],1)],1)],1),s("el-col",{attrs:{span:16}},[s("el-form-item",{attrs:{label:"下单时间"}},[s("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange","unlink-panels":""},model:{value:t.params.time,callback:function(e){t.$set(t.params,"time",e)},expression:"params.time"}})],1)],1)],1)],1),s("div",{staticClass:"operation-btns"},[s("el-button",{attrs:{size:"small"},on:{click:t.onClickFilter}},[t._v("筛选")]),s("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.onClickClearFilter}},[t._v("清空筛选条件")])],1)],1),s("div",{staticClass:"container"},[s("comp-tab",{attrs:{data:t.tabs},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),s("div",{staticClass:"container"},[t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"product-card"},[s("div",{staticClass:"product-card-head"},[s("span",{staticClass:"product-id"},[t._v(t._s(e.id))]),s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.needinvoice,expression:"item.needinvoice == 1"}],staticClass:"product-need-voice"},[t._v("需要开发票")]),s("div",{staticClass:"product-other-info"},[s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("\n            查看详情\n          ")])],1)]),s("table",{staticClass:"product-card-table"},[s("tr",[s("td",{attrs:{width:"100px"}},[s("span",{staticClass:"product-deliver-type",style:{backgroundColor:t.getProductDeliverTypeColor(e.deliverkind)}},[t._v("\n              "+t._s(t.getProductDeliverType(e.deliverkind))+" ")]),s("br"),1==e.deliverkind?s("span",{staticClass:"product-deliver-time"},[t._v(t._s(new Date(1e3*e.delivertime).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+" ")]):t._e(),s("br"),1==e.deliverkind&&e.delivertime<parseInt(Date.now()/1e3)&&3==e.status?s("span",{staticClass:"product-out-time"},[t._v("已超时")]):t._e(),2==e.deliverkind?s("span",{staticClass:"product-deliver-time"},[t._v("#"+t._s(e.daynumber)+" ")]):t._e()]),s("td",{staticStyle:{"text-align":"left","vertical-align":"top"},attrs:{width:"240px"}},t._l(e.orderproductsList,function(e){return s("span",{key:e.productid},[t._v(" "+t._s(e.product.name)+" "+t._s(e.optionname&&"("+Object.values(JSON.parse(e.optionname)).join(", ")+")")+" × "+t._s(e.quantity)),s("br")])})),s("td",{attrs:{width:"80px"}},[t._v("\n            "+t._s(e.user.nickname)),s("br"),t._v("\n            "+t._s(e.user.mobile)),s("br"),2===e.user.isvip?s("span",{staticClass:"product-member-tag"},[t._v("会员")]):t._e()]),s("td",{attrs:{width:"80px"}},[t._v("\n            "+t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n          ")]),s("td",{attrs:{width:"80px"}},[t._v("￥"+t._s((e.actualamount+e.freight)/1e3))]),s("td",{staticStyle:{"text-align":"left","vertical-align":"top"}},[t._v("\n            "+t._s(e.note)+"\n          ")]),s("td",{attrs:{width:"100px"}},[t._v("\n            "+t._s(t.getOrderStatus(e.status,e.deliverkind))+"\n            "),s("tr"),12===e.status?[s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.updateOrder(e,8)}}},[t._v("\n                退款\n              ")]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.updateOrder(e,2)}}},[t._v("\n                拒绝\n              ")])]:t._e(),2===e.status?[s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.updateOrder(e,8)}}},[t._v("\n                退款\n              ")]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.updateOrder(e,3)}}},[t._v("\n                确认接单\n              ")])]:t._e()],2)])])])}),t.list.length?t._e():s("div",{staticClass:"list-nodata"},[s("div",[t._v("暂无数据")])]),t.list.length?s("div",{staticClass:"table-bottom"},[t.hasMore?s("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getOrders}},[t._v("加载更多")]):s("p",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1):t._e()],2)])},tt=[],et={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},st=[{value:0,label:"所有订单"},{value:"1",label:"自提"},{value:"2",label:"外卖"}],at={0:"等待顾客支付","2_1":"等待商家备货","2_2":"等待商家发货","3_1":"等待顾客取货","3_2":"已接单待收货",4:"已完成",6:"顾客已取消订单",8:"已退款",12:"顾客请求退款"},it=function(t,e){return at[t]||at["".concat(t,"_").concat(e)]},rt={components:{"comp-tab":d["a"]},name:"order-list",watch:{"params.status":function(){this.list=[],this.getOrders()}},data:function(){return{tabs:[{label:"全部订单",value:-1},{label:"待退款",value:12},{label:"已退款",value:8}],pickerOptions:et,deliverkinds:st,list:[],params:{id:"",status:-1,statuslistList:[12,8],idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isprofitsharing:0,time:[]},token:"",loadmore:!1,hasMore:!0}},created:function(){this.token=Object(m["e"])(),this.getOrders()},methods:{getOrders:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i,r,n,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.loadmore=!0,e=window,s=e.scrollY,this.params.createdatgreaterthan=0,this.params.createdatlessthan=0,2===this.params.time.length&&(this.params.createdatgreaterthan=parseInt(this.params.time[0].getTime()/1e3),this.params.createdatlessthan=parseInt(this.params.time[1].getTime()/1e3)),!this.params.delivermobile){t.next=10;break}return t.next=8,Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),mobile:this.params.delivermobile,count:1,order:0}));case 8:a=t.sent,this.params.userid=a.userlistList.length?a.userlistList[0].id:0;case 10:return this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,t.next=13,Object(p["a"])("StoreOrderService.GetOrderList",Object(u["a"])("OrderListQueryRequest",Object(o["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params)));case 13:if(i=t.sent,0!==i.orderlistList.length){t.next=18;break}return this.loadmore=!1,this.hasMore=!1,t.abrupt("return");case 18:return r=i.orderlistList.map(function(t){return t.userid}),n=[],i.orderlistList.forEach(function(t){t.orderproductsList.forEach(function(t){n.push(t.productid)})}),t.next=23,Promise.all([Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length,order:0})),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:n,sortby:1,sort:1,count:n.length}))]);case 23:l=t.sent,i.orderlistList.forEach(function(t){t.user=l[0].userlistList.find(function(e){return e.id===t.userid}),t.orderproductsList.forEach(function(t){t.product=l[1].productlistList.find(function(e){return e.id===t.productid})})}),this.list=this.list.concat(i.orderlistList),this.hasMore=i.orderlistList.length,this.loadmore=!1,0!==this.params.idlessthan&&window.scroll(0,s);case 29:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onClickFilter:function(){this.list=[],this.getOrders()},onClickClearFilter:function(){this.params={id:"",status:-1,statuslistList:null,idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",time:[]},this.list=[],this.getOrders()},getProductDeliverType:function(t){return 1===t?"自提":2===t?"外卖":""},getProductDeliverTypeColor:function(t){return 1===t?"#549f44":2===t?"#559cda":""},getOrderStatus:it,updateOrder:function(t,e){var s=this;t=JSON.parse(JSON.stringify(t)),t.status=e,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},t,{address:Object(u["a"])("Address",t.address),invoice:Object(u["a"])("Invoice",t.invoice),orderproductsList:t.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(e){s.list.splice(s.list.findIndex(function(t){return t.id===e.id}),1,t),s.$message({message:"操作成功",type:"success"})})}}},nt=rt,lt=(s("a68a"),Object(k["a"])(nt,X,tt,!1,null,"704846b7",null)),ot=lt.exports,ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"container"},[s("el-form",{attrs:{"label-position":"right","label-width":"100px",size:"mini"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单号"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"外卖号/叫号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入外卖号或叫号"},model:{value:t.params.daynumber,callback:function(e){t.$set(t.params,"daynumber",e)},expression:"params.daynumber"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"桌号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入桌号号"},model:{value:t.params.desk,callback:function(e){t.$set(t.params,"desk",e)},expression:"params.desk"}})],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"订单类型"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.deliverkind,callback:function(e){t.$set(t.params,"deliverkind",e)},expression:"params.deliverkind"}},t._l(t.deliverkinds,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"是否分销"}},[s("el-select",{attrs:{placeholder:"请选择订单类型"},model:{value:t.params.isprofitsharing,callback:function(e){t.$set(t.params,"isprofitsharing",e)},expression:"params.isprofitsharing"}},[s("el-option",{attrs:{label:"全部",value:0}}),s("el-option",{attrs:{label:"非分销",value:1}}),s("el-option",{attrs:{label:"分销单",value:2}})],1)],1)],1)],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"下单人手机号"}},[s("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入下单人手机号"},model:{value:t.params.useridormobile,callback:function(e){t.$set(t.params,"useridormobile",e)},expression:"params.useridormobile"}})],1)],1),s("el-col",{attrs:{span:16}},[s("el-form-item",{attrs:{label:"下单时间"}},[s("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange","unlink-panels":""},model:{value:t.params.time,callback:function(e){t.$set(t.params,"time",e)},expression:"params.time"}})],1)],1)],1)],1),s("div",{staticClass:"operation-btns"},[s("el-button",{attrs:{size:"small"},on:{click:t.onClickFilter}},[t._v("筛选")]),s("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.onClickClearFilter}},[t._v("清空筛选条件")])],1)],1),s("div",{staticClass:"container"},[s("comp-tab",{attrs:{data:t.tabs},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),s("div",{staticClass:"container"},[t._l(t.list,function(e){return s("div",{key:e.id,staticClass:"product-card"},[s("div",{staticClass:"product-card-head"},[s("span",{staticClass:"product-id"},[t._v(t._s(e.id))]),s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.needinvoice,expression:"item.needinvoice == 1"}],staticClass:"product-need-voice"},[t._v("需要开发票")]),s("div",{staticClass:"product-other-info"},[s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(s){t.$router.push({name:"order-detail",query:{id:e.id}})}}},[t._v("\n            查看详情\n          ")])],1)]),s("table",{staticClass:"product-card-table"},[s("tr",[s("td",{attrs:{width:"100px"}},[s("span",{staticClass:"product-deliver-type",style:{backgroundColor:t.getProductDeliverTypeColor(e.deliverkind)}},[t._v("\n              "+t._s(t.getProductDeliverType(e.deliverkind))+" ")]),s("br"),1==e.deliverkind?s("span",{staticClass:"product-deliver-time"},[t._v(t._s(new Date(1e3*e.delivertime).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+" ")]):t._e(),s("br"),1==e.deliverkind&&e.delivertime<parseInt(Date.now()/1e3)&&3==e.status?s("span",{staticClass:"product-out-time"},[t._v("已超时")]):t._e(),2==e.deliverkind?s("span",{staticClass:"product-deliver-time"},[t._v("#"+t._s(e.daynumber)+" ")]):t._e(),3==e.deliverkind?s("span",{staticClass:"product-deliver-time"},[t._v("#"+t._s(e.desk)+" ")]):t._e(),4==e.deliverkind?s("span",{staticClass:"product-deliver-time"},[t._v("#"+t._s(e.daynumber)+" ")]):t._e()]),s("td",{staticStyle:{"text-align":"left","vertical-align":"top"},attrs:{width:"240px"}},t._l(e.orderproductsList,function(e){return s("span",{key:e.productid},[t._v(" "+t._s(e.product.name)+" "+t._s(e.optionname&&"("+Object.values(JSON.parse(e.optionname)).join(", ")+")")+" × "+t._s(e.quantity)),s("br")])})),s("td",{attrs:{width:"80px"}},[t._v("\n            "+t._s(e.user.nickname)),s("br"),t._v("\n            "+t._s(e.user.mobile)),s("br"),2===e.user.isvip?s("span",{staticClass:"product-member-tag"},[t._v("会员")]):t._e()]),s("td",{attrs:{width:"80px"}},[t._v("\n            "+t._s(new Date(1e3*e.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n          ")]),s("td",{attrs:{width:"80px"}},[t._v("￥"+t._s((e.actualamount+e.freight)/1e3))]),s("td",{staticStyle:{"text-align":"left","vertical-align":"top"}},[t._v("\n            "+t._s(e.note)+"\n          ")]),s("td",{attrs:{width:"100px"}},[t._v("\n            "+t._s(t.getOrderStatus(e.status,e.deliverkind))+"\n            "),s("tr"),12===e.status?[s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.update(e,8)}}},[t._v("\n                退款\n              ")]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.update(e,2)}}},[t._v("\n                拒绝\n              ")])]:t._e(),2===e.status?[s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.update(e,8)}}},[t._v("\n                退款\n              ")]),s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.update(e,3)}}},[t._v("\n                确认接单\n              ")])]:t._e()],2)])])])}),t.list.length?t._e():s("div",{staticClass:"list-nodata"},[s("div",[t._v("暂无数据")])]),t.list.length?s("div",{staticClass:"table-bottom"},[t.hasMore?s("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getOrders}},[t._v("加载更多")]):s("p",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1):t._e()],2)])},dt=[],ut={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},pt=[{value:0,label:"所有订单"},{value:"3",label:"桌号堂食"},{value:"4",label:"叫号堂食"},{value:"1",label:"自提"},{value:"2",label:"外卖"}],mt={0:"等待顾客支付","2_1":"等待商家备货","2_2":"等待商家发货","2_3":"等待商家上菜","2_4":"等待商家备菜","3_1":"等待顾客取货","3_2":"已接单待收货","3_3":"已接单待收货","3_4":"已接单待收货",4:"已完成",6:"顾客已取消订单",8:"已退款",12:"顾客请求退款"},ht=function(t,e){return mt[t]||mt["".concat(t,"_").concat(e)]},vt={components:{"comp-tab":d["a"]},name:"order-list",watch:{"params.status":function(){this.list=[],this.getOrders()}},data:function(){return{tabs:[{label:"全部订单",value:-1},{label:"待退款",value:12},{label:"已退款",value:8}],pickerOptions:ut,deliverkinds:pt,list:[],params:{id:"",status:-1,statuslistList:[12,8],idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",isprofitsharing:0,time:[]},loadmore:!1,hasMore:!0}},created:function(){this.token=Object(m["e"])(),this.getOrders()},methods:{getOrders:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,a,i,r,n,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.loadmore=!0,e=window,s=e.scrollY,this.params.createdatgreaterthan=0,this.params.createdatlessthan=0,2===this.params.time.length&&(this.params.createdatgreaterthan=parseInt(this.params.time[0].getTime()/1e3),this.params.createdatlessthan=parseInt(this.params.time[1].getTime()/1e3)),!this.params.delivermobile){t.next=10;break}return t.next=8,Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),mobile:this.params.delivermobile,count:1,order:0}));case 8:a=t.sent,this.params.userid=a.userlistList.length?a.userlistList[0].id:0;case 10:return this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,t.next=13,Object(p["a"])("StoreOrderService.GetOrderList",Object(u["a"])("OrderListQueryRequest",Object(o["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params)));case 13:if(i=t.sent,0!==i.orderlistList.length){t.next=18;break}return this.loadmore=!1,this.hasMore=!1,t.abrupt("return");case 18:return r=i.orderlistList.map(function(t){return t.userid}),n=[],i.orderlistList.forEach(function(t){t.orderproductsList.forEach(function(t){n.push(t.productid)})}),t.next=23,Promise.all([Object(p["a"])("StoreUserService.GetUserList",Object(u["a"])("UserListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length,order:0})),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:n,sortby:1,sort:1,count:n.length}))]);case 23:l=t.sent,i.orderlistList.forEach(function(t){t.user=l[0].userlistList.find(function(e){return e.id===t.userid}),t.orderproductsList.forEach(function(t){t.product=l[1].productlistList.find(function(e){return e.id===t.productid})})}),this.list=this.list.concat(i.orderlistList),this.hasMore=i.orderlistList.length,this.loadmore=!1,0!==this.params.idlessthan&&window.scroll(0,s);case 29:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onClickFilter:function(){this.list=[],this.getOrders()},onClickClearFilter:function(){this.params={id:"",status:-1,statuslistList:null,idlessthan:0,createdatgreaterthan:0,createdatlessthan:0,sortby:1,sort:1,deliverkind:0,desk:"",daynumber:"",count:20,delivermobile:"",time:[]},this.list=[],this.getOrders()},getProductDeliverType:function(t){return 1===t?"自提":2===t?"外卖":3===t?"桌号堂食":4===t?"叫号堂食":""},getProductDeliverTypeColor:function(t){return 1===t?"#549f44":2===t?"#559cda":3===t||4===t?"#cd4a58":""},getOrderStatus:ht,update:function(t,e){var s=this;t.status=e,Object(p["a"])("StoreOrderService.UpdateOrder",Object(u["a"])("OrderWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),order:Object(u["a"])("Order",Object(o["a"])({},t,{address:Object(u["a"])("Address",t.address),invoice:Object(u["a"])("Invoice",t.invoice),orderproductsList:t.orderproductsList.map(function(t){return Object(u["a"])("OrderProduct",t)})}))})).then(function(e){s.list.splice(s.list.findIndex(function(t){return t.id===e.id}),1,t),s.$message({message:"操作成功",type:"success"})})}}},bt=vt,ft=(s("3f0a"),Object(k["a"])(bt,ct,dt,!1,null,"18113bee",null)),kt=ft.exports,gt={_0:_,_1:S,_2:U,_3:Q,_4:K,_6:ot,_7:kt},_t={0:"_0",1:"_1",2:"_2",3:"_3",4:"_4",6:"_6",7:"_7"},Ot=Object(r["a"])({name:"order-list-entry",components:gt,map:_t}),yt=Ot,Ct=Object(k["a"])(yt,a,i,!1,null,null,null);e["default"]=Ct.exports}}]);
//# sourceMappingURL=order-refund.5238037f.js.map