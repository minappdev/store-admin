(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["marketing-banner"],{"0224":function(t,e,i){"use strict";var n=i("305d"),r=i.n(n);r.a},"04af":function(t,e,i){},"185e":function(t,e,i){"use strict";var n=i("e0f2"),r=i.n(n);r.a},"20d6":function(t,e,i){"use strict";var n=i("5ca1"),r=i("0a49")(6),o="findIndex",s=!0;o in[]&&Array(1)[o](function(){s=!1}),n(n.P+n.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(o)},"305d":function(t,e,i){},"386b":function(t,e,i){var n=i("5ca1"),r=i("79e5"),o=i("be13"),s=/"/g,a=function(t,e,i,n){var r=String(o(t)),a="<"+e;return""!==i&&(a+=" "+i+'="'+String(n).replace(s,"&quot;")+'"'),a+">"+r+"</"+e+">"};t.exports=function(t,e){var i={};i[t]=e(a),n(n.P+n.F*r(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",i)}},"3d43":function(t,e,i){"use strict";var n=i("c70c"),r=i.n(n);r.a},43196:function(t,e,i){"use strict";var n=i("4e46"),r=i.n(n);r.a},"4e46":function(t,e,i){},"5e24":function(t,e,i){"use strict";var n=i("f87f"),r=i.n(n);r.a},"80bf":function(t,e,i){"use strict";i("96cf");var n=i("1da1"),r=(i("7f7f"),i("a3fb"));e["a"]=function(t){var e=t.name,i=t.components,o=t.map;return{name:e,components:i,data:function(){return{store:{}}},created:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(r["b"])();case 2:this.store=t.sent;case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),render:function(t){return t(o[this.store.kind])}}}},a4b3:function(t,e,i){"use strict";var n=i("c212"),r=i.n(n);r.a},b54a:function(t,e,i){"use strict";i("386b")("link",function(t){return function(e){return t(this,"a","href",e)}})},bf83:function(t,e,i){"use strict";i.r(e);var n,r,o=i("80bf"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container main"},[t._m(0),i("div",{staticClass:"upload-list"},[i("div",{staticStyle:{"font-size":"18px","line-height":"2.225",color:"#666",display:"flex","align-items":"center",width:"375px"}},[i("div",{staticStyle:{flex:"1"}},[t._v("\n          上传轮播图\n          "),i("i",{staticClass:"el-icon-loading",style:{display:t.syncing?"":"none"}})]),t.list.length<5?i("el-upload",{attrs:{"show-file-list":!1,"on-change":t.addImage,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("上传文件")])],1):t._e()],1),i("p",{staticStyle:{"font-size":"12px",color:"#ccc"}},[t._v("最多上传5张图片，最佳比例3:1")]),t._l(t.list,function(e,n){return i("div",{key:e,staticClass:"upload-item"},[i("div",{staticClass:"upload-item-image",style:{"background-image":"url("+e.image+")"}},[i("div",{staticClass:"upload-item-image-cover"},[e.product?t._e():i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"4px",color:"rgb(206, 55, 46)"}}),t._v("\n              暂未配置跳转，点击进行配置\n            ")]),e.product?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              商品 "+t._s(e.product.name)+"\n            ")]):t._e()])]),i("div",{staticClass:"upload-item-op"},[i("el-tooltip",{attrs:{effect:"dark",content:"删除该图片",placement:"right"}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){t.deleteRow(e)}}})]),i("el-tooltip",{attrs:{effect:"dark",content:"置顶图片",placement:"right"}},[0!==n?i("i",{staticClass:"el-icon-caret-top",on:{click:function(i){t.updateRowTopTime(e)}}}):t._e()])],1)])})],2)]),i("el-dialog",{attrs:{title:"设置跳转结果",visible:t.showDialog,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"banner-dialog"},[i("div",{staticClass:"banner-dialog-radio-group"},[i("el-radio",{attrs:{label:"product://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("商品")])],1),"product://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入商品名后选择添加")]):t._e(),"product://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.row.link,callback:function(e){t.$set(t.row,"link",e)},expression:"row.link"}},t._l(t.products,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e()])])],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"preview"})])}],c=i("be94"),l=(i("20d6"),i("7514"),i("ac6a"),i("b54a"),i("f559"),i("96cf"),i("1da1")),u=i("e8e1"),d=i("8e44"),p=i("73cd"),h={name:"Banner",data:function(){return{row:{},showDialog:!1,token:Object(p["e"])(),syncing:!1,products:[],list:[]}},mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.GetSlideShowList",Object(u["a"])("SlideShowListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),count:100}));case 2:return e=t.sent,i=e.slideshowlistList.filter(function(t){return t.link.startsWith("product://")}).map(function(t){return t.link.slice(10)}),t.next=6,Object(d["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:i,count:i.length,sortby:1,sort:1}));case 6:n=t.sent,e.slideshowlistList.forEach(function(t){return t.product=n.productlistList.find(function(e){return e.id==t.link.slice(10)})}),this.list=e.slideshowlistList;case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addImage:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i,n,r,o,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=new FileReader,n=e.raw,r="image/jpeg"===n.type||"image/png"===n.type,o=n.size/1024/1024<2,s=function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return a.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),t.abrupt("return");case 3:if(o){t.next=6;break}return a.$message.error("上传图片大小不能超过 2MB!"),t.abrupt("return");case 6:return a.syncing=!0,e=new FormData,e.append("file",n),t.next=11,fetch("https://file.sansanll.com",{method:"POST",body:e,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return"".concat(t.file)});case 11:return i=t.sent,t.next=14,Object(d["a"])("StoreSlideShowService.CreateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:a.token}),slideshow:Object(u["a"])("SlideShow",{image:i,toptime:parseInt(Date.now()/1e3)})}));case 14:s=t.sent,a.list.splice(0,0,s),a.syncing=!1;case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i.onload=function(t){var e=new Image;e.onload=function(){e.width,e.height;s()},e.src=t.target.result},i.readAsDataURL(n);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),editRow:function(t){t=JSON.parse(JSON.stringify(t)),t.linkprefix="",t.link.startsWith("product://")&&(t.linkprefix="product://",t.link=t.link.slice(10)),""==t.linkprefix&&(t.link=""),this.row=t,this.showDialog=!0},deleteRow:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.DeleteSlideShow",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:e.id}));case 2:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowTopTime:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=JSON.parse(JSON.stringify(e)),t.next=3,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{toptime:parseInt(Date.now()/1e3)}))}));case 3:i=t.sent,i.product=e.product,this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1),this.list.splice(0,0,i);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowLink:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.row.linkprefix&&this.row.link){t.next=3;break}return this.showDialog=!1,t.abrupt("return");case 3:return e=JSON.parse(JSON.stringify(this.row)),t.next=6,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{link:e.linkprefix+e.link}))}));case 6:if(i=t.sent,!i.link.startsWith("product://")){t.next=11;break}return t.next=10,Object(d["a"])("StoreProductService.GetProduct",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(10)}));case 10:i.product=t.sent;case 11:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1,i),this.showDialog=!1;case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(d["b"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})}}},f=h,k=(i("43196"),i("2877")),w=Object(k["a"])(f,s,a,!1,null,"7f8d53b1",null),g=w.exports,b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container main"},[t._m(0),i("div",{staticClass:"upload-list"},[i("div",{staticStyle:{"font-size":"18px","line-height":"2.225",color:"#666",display:"flex","align-items":"center",width:"375px"}},[i("div",{staticStyle:{flex:"1"}},[t._v("\n          上传轮播图\n          "),i("i",{staticClass:"el-icon-loading",style:{display:t.syncing?"":"none"}})]),t.list.length<5?i("el-upload",{attrs:{"show-file-list":!1,"on-change":t.addImage,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("上传文件")])],1):t._e()],1),i("p",{staticStyle:{"font-size":"12px",color:"#ccc"}},[t._v("最多上传5张图片，最佳比例3:1")]),t._l(t.list,function(e,n){return i("div",{key:e,staticClass:"upload-item"},[i("div",{staticClass:"upload-item-image",style:{"background-image":"url("+e.image+")"}},[i("div",{staticClass:"upload-item-image-cover"},[e.product?t._e():i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"4px",color:"rgb(206, 55, 46)"}}),t._v("\n              暂未配置跳转，点击进行配置\n            ")]),e.product?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              商品 "+t._s(e.product.name)+"\n            ")]):t._e()])]),i("div",{staticClass:"upload-item-op"},[i("el-tooltip",{attrs:{effect:"dark",content:"删除该图片",placement:"right"}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){t.deleteRow(e)}}})]),i("el-tooltip",{attrs:{effect:"dark",content:"置顶图片",placement:"right"}},[0!==n?i("i",{staticClass:"el-icon-caret-top",on:{click:function(i){t.updateRowTopTime(e)}}}):t._e()])],1)])})],2)]),i("el-dialog",{attrs:{title:"设置跳转结果",visible:t.showDialog,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"banner-dialog"},[i("div",{staticClass:"banner-dialog-radio-group"},[i("el-radio",{attrs:{label:"product://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("商品")])],1),"product://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入商品名后选择添加")]):t._e(),"product://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.row.link,callback:function(e){t.$set(t.row,"link",e)},expression:"row.link"}},t._l(t.products,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e()])])],1)},m=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"preview"})])}],S={name:"Banner",data:function(){return{row:{},showDialog:!1,token:Object(p["e"])(),syncing:!1,products:[],list:[]}},mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.GetSlideShowList",Object(u["a"])("SlideShowListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),count:100}));case 2:return e=t.sent,i=e.slideshowlistList.filter(function(t){return t.link.startsWith("product://")}).map(function(t){return t.link.slice(10)}),t.next=6,Object(d["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:i,count:i.length,sortby:1,sort:1}));case 6:n=t.sent,e.slideshowlistList.forEach(function(t){return t.product=n.productlistList.find(function(e){return e.id==t.link.slice(10)})}),this.list=e.slideshowlistList;case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addImage:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i,n,r,o,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=new FileReader,n=e.raw,r="image/jpeg"===n.type||"image/png"===n.type,o=n.size/1024/1024<2,s=function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return a.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),t.abrupt("return");case 3:if(o){t.next=6;break}return a.$message.error("上传图片大小不能超过 2MB!"),t.abrupt("return");case 6:return a.syncing=!0,e=new FormData,e.append("file",n),t.next=11,fetch("https://file.sansanll.com",{method:"POST",body:e,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return"".concat(t.file)});case 11:return i=t.sent,t.next=14,Object(d["a"])("StoreSlideShowService.CreateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:a.token}),slideshow:Object(u["a"])("SlideShow",{image:i,toptime:parseInt(Date.now()/1e3)})}));case 14:s=t.sent,a.list.splice(0,0,s),a.syncing=!1;case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i.onload=function(t){var e=new Image;e.onload=function(){e.width,e.height;s()},e.src=t.target.result},i.readAsDataURL(n);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),editRow:function(t){t=JSON.parse(JSON.stringify(t)),t.linkprefix="",t.link.startsWith("product://")&&(t.linkprefix="product://",t.link=t.link.slice(10)),""==t.linkprefix&&(t.link=""),this.row=t,this.showDialog=!0},deleteRow:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.DeleteSlideShow",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:e.id}));case 2:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowTopTime:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=JSON.parse(JSON.stringify(e)),t.next=3,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{toptime:parseInt(Date.now()/1e3)}))}));case 3:i=t.sent,i.product=e.product,this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1),this.list.splice(0,0,i);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowLink:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.row.linkprefix&&this.row.link){t.next=3;break}return this.showDialog=!1,t.abrupt("return");case 3:return e=JSON.parse(JSON.stringify(this.row)),t.next=6,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{link:e.linkprefix+e.link}))}));case 6:if(i=t.sent,!i.link.startsWith("product://")){t.next=11;break}return t.next=10,Object(d["a"])("StoreProductService.GetProduct",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(10)}));case 10:i.product=t.sent;case 11:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1,i),this.showDialog=!1;case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(d["b"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})}}},v=S,O=(i("0224"),Object(k["a"])(v,b,m,!1,null,"53d3cf60",null)),x=O.exports,j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container main"},[t._m(0),i("div",{staticClass:"upload-list"},[i("div",{staticStyle:{"font-size":"18px","line-height":"2.225",color:"#666",display:"flex","align-items":"center",width:"375px"}},[i("div",{staticStyle:{flex:"1"}},[t._v("\n          上传轮播图\n          "),i("i",{staticClass:"el-icon-loading",style:{display:t.syncing?"":"none"}})]),t.list.length<5?i("el-upload",{attrs:{"show-file-list":!1,"on-change":t.addImage,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("上传文件")])],1):t._e()],1),i("p",{staticStyle:{"font-size":"12px",color:"#ccc"}},[t._v("最多上传5张图片，最佳比例3:1")]),t._l(t.list,function(e,n){return i("div",{key:e,staticClass:"upload-item"},[i("div",{staticClass:"upload-item-image",style:{"background-image":"url("+e.image+")"}},[i("div",{staticClass:"upload-item-image-cover"},[e.product||e.course?t._e():i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"4px",color:"rgb(206, 55, 46)"}}),t._v("\n              暂未配置跳转，点击进行配置\n            ")]),e.product?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              商品 "+t._s(e.product.name)+"\n            ")]):t._e(),e.course?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              报名课程 "+t._s(e.course.name)+"\n            ")]):t._e()])]),i("div",{staticClass:"upload-item-op"},[i("el-tooltip",{attrs:{effect:"dark",content:"删除该图片",placement:"right"}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){t.deleteRow(e)}}})]),i("el-tooltip",{attrs:{effect:"dark",content:"置顶图片",placement:"right"}},[0!==n?i("i",{staticClass:"el-icon-caret-top",on:{click:function(i){t.updateRowTopTime(e)}}}):t._e()])],1)])})],2)]),i("el-dialog",{attrs:{title:"设置跳转结果",visible:t.showDialog,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"banner-dialog"},[i("div",{staticClass:"banner-dialog-radio-group"},[i("el-radio",{attrs:{label:"product://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("商品")]),i("el-radio",{attrs:{label:"course://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("报名课程")])],1),"product://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入商品名后选择添加")]):t._e(),"product://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.row.productid,callback:function(e){t.$set(t.row,"productid",e)},expression:"row.productid"}},t._l(t.products,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e(),"course://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入报名课程后选择添加")]):t._e(),"course://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getCourses,placeholder:"搜索报名课程"},model:{value:t.row.courseid,callback:function(e){t.$set(t.row,"courseid",e)},expression:"row.courseid"}},t._l(t.courses,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e()])])],1)},y=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"preview"})])}],R={name:"Banner",data:function(){return{row:{},showDialog:!1,token:Object(p["e"])(),syncing:!1,products:[],courses:[],list:[]}},mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,n,r,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.GetSlideShowList",Object(u["a"])("SlideShowListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),count:100}));case 2:return e=t.sent,i=e.slideshowlistList.filter(function(t){return t.link.startsWith("product://")}).map(function(t){return t.link.slice(10)}),t.next=6,Object(d["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:i,count:i.length,sortby:1,sort:1}));case 6:return n=t.sent,e.slideshowlistList.forEach(function(t){return t.product=n.productlistList.find(function(e){return e.id==t.link.slice(10)})}),r=e.slideshowlistList.filter(function(t){return t.link.startsWith("course://")}).map(function(t){return t.link.slice(9)}),t.next=11,Object(d["a"])("StoreCourseService.GetCourseList",Object(u["a"])("CourseListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length}));case 11:o=t.sent,e.slideshowlistList.forEach(function(t){return t.course=o.courselistList.find(function(e){return e.id==t.link.slice(9)})}),this.list=e.slideshowlistList;case 14:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addImage:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i,n,r,o,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=new FileReader,n=e.raw,r="image/jpeg"===n.type||"image/png"===n.type,o=n.size/1024/1024<2,s=function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return a.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),t.abrupt("return");case 3:if(o){t.next=6;break}return a.$message.error("上传图片大小不能超过 2MB!"),t.abrupt("return");case 6:return a.syncing=!0,e=new FormData,e.append("file",n),t.next=11,fetch("https://file.sansanll.com",{method:"POST",body:e,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return"".concat(t.file)});case 11:return i=t.sent,t.next=14,Object(d["a"])("StoreSlideShowService.CreateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:a.token}),slideshow:Object(u["a"])("SlideShow",{image:i,toptime:parseInt(Date.now()/1e3)})}));case 14:s=t.sent,a.list.splice(0,0,s),a.syncing=!1;case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i.onload=function(t){var e=new Image;e.onload=function(){e.width,e.height;s()},e.src=t.target.result},i.readAsDataURL(n);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),editRow:function(t){t=JSON.parse(JSON.stringify(t)),t.linkprefix="",t.productid="",t.courseid="",t.link.startsWith("product://")&&(t.linkprefix="product://",t.productid=t.link.slice(10)),t.link.startsWith("course://")&&(t.linkprefix="course://",t.courseid=t.link.slice(9)),this.row=t,this.showDialog=!0},deleteRow:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.DeleteSlideShow",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:e.id}));case 2:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowTopTime:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=JSON.parse(JSON.stringify(e)),t.next=3,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{toptime:parseInt(Date.now()/1e3)}))}));case 3:i=t.sent,i.product=e.product,i.course=e.course,this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1),this.list.splice(0,0,i);case 8:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowLink:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.row.linkprefix&&("product://"!=this.row.linkprefix||this.row.productid)&&("course://"!=this.row.linkprefix||this.row.courseid)){t.next=3;break}return this.showDialog=!1,t.abrupt("return");case 3:return e=JSON.parse(JSON.stringify(this.row)),t.next=6,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{link:"product://"==e.linkprefix?e.linkprefix+e.productid:e.linkprefix+e.courseid}))}));case 6:if(i=t.sent,!i.link.startsWith("product://")){t.next=11;break}return t.next=10,Object(d["a"])("StoreProductService.GetProduct",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(10)}));case 10:i.product=t.sent;case 11:if(!i.link.startsWith("course://")){t.next=15;break}return t.next=14,Object(d["a"])("StoreCourseService.GetCourse",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(9)}));case 14:i.course=t.sent;case 15:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1,i),this.showDialog=!1;case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(d["b"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},getCourses:function(t){var e=this;if(!t)return this.courses=[];this.fetchProductLoading=!0,Object(d["b"])("StoreCourseService.GetCourseList",Object(u["a"])("CourseListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),containsname:t,applyendtimegreaterthan:parseInt(Date.now()/1e3),count:100})).then(function(t){e.courses=t.courselistList,e.fetchProductLoading=!1})}}},_=R,L=(i("a4b3"),Object(k["a"])(_,j,y,!1,null,"631ae40e",null)),C=L.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container main"},[t._m(0),i("div",{staticClass:"upload-list"},[i("div",{staticStyle:{"font-size":"18px","line-height":"2.225",color:"#666",display:"flex","align-items":"center",width:"375px"}},[i("div",{staticStyle:{flex:"1"}},[t._v("\n          上传轮播图\n          "),i("i",{staticClass:"el-icon-loading",style:{display:t.syncing?"":"none"}})]),t.list.length<5?i("el-upload",{attrs:{"show-file-list":!1,"on-change":t.addImage,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("上传文件")])],1):t._e()],1),i("p",{staticStyle:{"font-size":"12px",color:"#ccc"}},[t._v("最多上传5张图片，最佳比例3:1")]),t._l(t.list,function(e,n){return i("div",{key:e,staticClass:"upload-item"},[i("div",{staticClass:"upload-item-image",style:{"background-image":"url("+e.image+")"}},[i("div",{staticClass:"upload-item-image-cover"},[e.product?t._e():i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"4px",color:"rgb(206, 55, 46)"}}),t._v("\n              暂未配置跳转，点击进行配置\n            ")]),e.product?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              商品 "+t._s(e.product.name)+"\n            ")]):t._e()])]),i("div",{staticClass:"upload-item-op"},[i("el-tooltip",{attrs:{effect:"dark",content:"删除该图片",placement:"right"}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){t.deleteRow(e)}}})]),i("el-tooltip",{attrs:{effect:"dark",content:"置顶图片",placement:"right"}},[0!==n?i("i",{staticClass:"el-icon-caret-top",on:{click:function(i){t.updateRowTopTime(e)}}}):t._e()])],1)])})],2)]),i("el-dialog",{attrs:{title:"设置跳转结果",visible:t.showDialog,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"banner-dialog"},[i("div",{staticClass:"banner-dialog-radio-group"},[i("el-radio",{attrs:{label:"product://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("商品")])],1),"product://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入商品名后选择添加")]):t._e(),"product://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.row.link,callback:function(e){t.$set(t.row,"link",e)},expression:"row.link"}},t._l(t.products,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e()])])],1)},P=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"preview"})])}],D={name:"Banner",data:function(){return{row:{},showDialog:!1,token:Object(p["e"])(),syncing:!1,products:[],list:[]}},mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.GetSlideShowList",Object(u["a"])("SlideShowListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),count:100}));case 2:return e=t.sent,i=e.slideshowlistList.filter(function(t){return t.link.startsWith("product://")}).map(function(t){return t.link.slice(10)}),t.next=6,Object(d["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:i,count:i.length,sortby:1,sort:1}));case 6:n=t.sent,e.slideshowlistList.forEach(function(t){return t.product=n.productlistList.find(function(e){return e.id==t.link.slice(10)})}),this.list=e.slideshowlistList;case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addImage:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i,n,r,o,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=new FileReader,n=e.raw,r="image/jpeg"===n.type||"image/png"===n.type,o=n.size/1024/1024<2,s=function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return a.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),t.abrupt("return");case 3:if(o){t.next=6;break}return a.$message.error("上传图片大小不能超过 2MB!"),t.abrupt("return");case 6:return a.syncing=!0,e=new FormData,e.append("file",n),t.next=11,fetch("https://file.sansanll.com",{method:"POST",body:e,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return"".concat(t.file)});case 11:return i=t.sent,t.next=14,Object(d["a"])("StoreSlideShowService.CreateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:a.token}),slideshow:Object(u["a"])("SlideShow",{image:i,toptime:parseInt(Date.now()/1e3)})}));case 14:s=t.sent,a.list.splice(0,0,s),a.syncing=!1;case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i.onload=function(t){var e=new Image;e.onload=function(){e.width,e.height;s()},e.src=t.target.result},i.readAsDataURL(n);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),editRow:function(t){t=JSON.parse(JSON.stringify(t)),t.linkprefix="",t.link.startsWith("product://")&&(t.linkprefix="product://",t.link=t.link.slice(10)),""==t.linkprefix&&(t.link=""),this.row=t,this.showDialog=!0},deleteRow:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.DeleteSlideShow",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:e.id}));case 2:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowTopTime:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=JSON.parse(JSON.stringify(e)),t.next=3,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{toptime:parseInt(Date.now()/1e3)}))}));case 3:i=t.sent,i.product=e.product,this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1),this.list.splice(0,0,i);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowLink:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.row.linkprefix&&this.row.link){t.next=3;break}return this.showDialog=!1,t.abrupt("return");case 3:return e=JSON.parse(JSON.stringify(this.row)),t.next=6,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{link:e.linkprefix+e.link}))}));case 6:if(i=t.sent,!i.link.startsWith("product://")){t.next=11;break}return t.next=10,Object(d["a"])("StoreProductService.GetProduct",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(10)}));case 10:i.product=t.sent;case 11:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1,i),this.showDialog=!1;case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(d["b"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})}}},I=D,W=(i("5e24"),Object(k["a"])(I,T,P,!1,null,"f9b0bce4",null)),q=W.exports,J=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container main"},[t._m(0),i("div",{staticClass:"upload-list"},[i("div",{staticStyle:{"font-size":"18px","line-height":"2.225",color:"#666",display:"flex","align-items":"center",width:"375px"}},[i("div",{staticStyle:{flex:"1"}},[t._v("\n          上传轮播图\n          "),i("i",{staticClass:"el-icon-loading",style:{display:t.syncing?"":"none"}})]),t.list.length<5?i("el-upload",{attrs:{"show-file-list":!1,"on-change":t.addImage,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("上传文件")])],1):t._e()],1),i("p",{staticStyle:{"font-size":"12px",color:"#ccc"}},[t._v("最多上传5张图片，最佳比例3:1")]),t._l(t.list,function(e,n){return i("div",{key:e,staticClass:"upload-item"},[i("div",{staticClass:"upload-item-image",style:{"background-image":"url("+e.image+")"}},[i("div",{staticClass:"upload-item-image-cover"},[e.product||e.subscription?t._e():i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"4px",color:"rgb(206, 55, 46)"}}),t._v("\n              暂未配置跳转，点击进行配置\n            ")]),e.product?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              商品 "+t._s(e.product.name)+"\n            ")]):t._e(),e.subscription?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              周期购 "+t._s(e.subscription.name)+"\n            ")]):t._e()])]),i("div",{staticClass:"upload-item-op"},[i("el-tooltip",{attrs:{effect:"dark",content:"删除该图片",placement:"right"}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){t.deleteRow(e)}}})]),i("el-tooltip",{attrs:{effect:"dark",content:"置顶图片",placement:"right"}},[0!==n?i("i",{staticClass:"el-icon-caret-top",on:{click:function(i){t.updateRowTopTime(e)}}}):t._e()])],1)])})],2)]),i("el-dialog",{attrs:{title:"设置跳转结果",visible:t.showDialog,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"banner-dialog"},[i("div",{staticClass:"banner-dialog-radio-group"},[i("el-radio",{attrs:{label:"product://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("商品")]),i("el-radio",{attrs:{label:"subscription://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("周期购")])],1),"product://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入商品名后选择添加")]):t._e(),"product://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.row.productid,callback:function(e){t.$set(t.row,"productid",e)},expression:"row.productid"}},t._l(t.products,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e(),"subscription://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入周期购后选择添加")]):t._e(),"subscription://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getSubscriptions,placeholder:"搜索周期购"},model:{value:t.row.subscriptionid,callback:function(e){t.$set(t.row,"subscriptionid",e)},expression:"row.subscriptionid"}},t._l(t.subscriptions,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e()])])],1)},N=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"preview"})])}],G={name:"Banner",data:function(){return{row:{},showDialog:!1,token:Object(p["e"])(),syncing:!1,products:[],subscriptions:[],list:[]}},mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,n,r,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.GetSlideShowList",Object(u["a"])("SlideShowListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),count:100}));case 2:return e=t.sent,i=e.slideshowlistList.filter(function(t){return t.link.startsWith("product://")}).map(function(t){return t.link.slice(10)}),t.next=6,Object(d["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:i,count:i.length,sortby:1,sort:1}));case 6:return n=t.sent,e.slideshowlistList.forEach(function(t){return t.product=n.productlistList.find(function(e){return e.id==t.link.slice(10)})}),r=e.slideshowlistList.filter(function(t){return t.link.startsWith("subscription://")}).map(function(t){return t.link.slice(15)}),t.next=11,Object(d["a"])("StoreSubscriptionService.GetSubscriptionList",Object(u["a"])("SubscriptionListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:r,count:r.length}));case 11:o=t.sent,e.slideshowlistList.forEach(function(t){return t.subscription=o.subscriptionlistList.find(function(e){return e.id==t.link.slice(15)})}),this.list=e.slideshowlistList;case 14:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addImage:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i,n,r,o,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=new FileReader,n=e.raw,r="image/jpeg"===n.type||"image/png"===n.type,o=n.size/1024/1024<2,s=function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return a.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),t.abrupt("return");case 3:if(o){t.next=6;break}return a.$message.error("上传图片大小不能超过 2MB!"),t.abrupt("return");case 6:return a.syncing=!0,e=new FormData,e.append("file",n),t.next=11,fetch("https://file.sansanll.com",{method:"POST",body:e,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return"".concat(t.file)});case 11:return i=t.sent,t.next=14,Object(d["a"])("StoreSlideShowService.CreateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:a.token}),slideshow:Object(u["a"])("SlideShow",{image:i,toptime:parseInt(Date.now()/1e3)})}));case 14:s=t.sent,a.list.splice(0,0,s),a.syncing=!1;case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i.onload=function(t){var e=new Image;e.onload=function(){e.width,e.height;s()},e.src=t.target.result},i.readAsDataURL(n);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),editRow:function(t){t=JSON.parse(JSON.stringify(t)),t.linkprefix="",t.productid="",t.subscriptionid="",t.link.startsWith("product://")&&(t.linkprefix="product://",t.productid=t.link.slice(10)),t.link.startsWith("subscription://")&&(t.linkprefix="subscription://",t.subscriptionid=t.link.slice(15)),this.row=t,this.showDialog=!0},deleteRow:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.DeleteSlideShow",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:e.id}));case 2:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowTopTime:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=JSON.parse(JSON.stringify(e)),t.next=3,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{toptime:parseInt(Date.now()/1e3)}))}));case 3:i=t.sent,i.product=e.product,i.subscription=e.subscription,this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1),this.list.splice(0,0,i);case 8:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowLink:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.row.linkprefix&&("product://"!=this.row.linkprefix||this.row.productid)&&("subscription://"!=this.row.linkprefix||this.row.subscriptionid)){t.next=3;break}return this.showDialog=!1,t.abrupt("return");case 3:return e=JSON.parse(JSON.stringify(this.row)),t.next=6,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{link:"product://"==e.linkprefix?e.linkprefix+e.productid:e.linkprefix+e.subscriptionid}))}));case 6:if(i=t.sent,!i.link.startsWith("product://")){t.next=11;break}return t.next=10,Object(d["a"])("StoreProductService.GetProduct",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(10)}));case 10:i.product=t.sent;case 11:if(!i.link.startsWith("subscription://")){t.next=15;break}return t.next=14,Object(d["a"])("StoreSubscriptionService.GetSubscription",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(15)}));case 14:i.subscription=t.sent;case 15:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1,i),this.showDialog=!1;case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(d["b"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},getSubscriptions:function(t){var e=this;if(!t)return this.subscriptions=[];this.fetchProductLoading=!0,Object(d["b"])("StoreSubscriptionService.GetSubscriptionList",Object(u["a"])("SubscriptionListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,enabled:2,count:100})).then(function(t){e.subscriptions=t.subscriptionlistList,e.fetchProductLoading=!1})}}},z=G,$=(i("3d43"),Object(k["a"])(z,J,N,!1,null,"a6e1d012",null)),Q=$.exports,E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container main"},[t._m(0),i("div",{staticClass:"upload-list"},[i("div",{staticStyle:{"font-size":"18px","line-height":"2.225",color:"#666",display:"flex","align-items":"center",width:"375px"}},[i("div",{staticStyle:{flex:"1"}},[t._v("\n          上传轮播图\n          "),i("i",{staticClass:"el-icon-loading",style:{display:t.syncing?"":"none"}})]),t.list.length<5?i("el-upload",{attrs:{"show-file-list":!1,"on-change":t.addImage,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("上传文件")])],1):t._e()],1),i("p",{staticStyle:{"font-size":"12px",color:"#ccc"}},[t._v("最多上传5张图片，最佳比例3:1")]),t._l(t.list,function(e,n){return i("div",{key:e,staticClass:"upload-item"},[i("div",{staticClass:"upload-item-image",style:{"background-image":"url("+e.image+")"}},[i("div",{staticClass:"upload-item-image-cover"},[e.product?t._e():i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"4px",color:"rgb(206, 55, 46)"}}),t._v("\n              暂未配置跳转，点击进行配置\n            ")]),e.product?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              商品 "+t._s(e.product.name)+"\n            ")]):t._e()])]),i("div",{staticClass:"upload-item-op"},[i("el-tooltip",{attrs:{effect:"dark",content:"删除该图片",placement:"right"}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){t.deleteRow(e)}}})]),i("el-tooltip",{attrs:{effect:"dark",content:"置顶图片",placement:"right"}},[0!==n?i("i",{staticClass:"el-icon-caret-top",on:{click:function(i){t.updateRowTopTime(e)}}}):t._e()])],1)])})],2)]),i("el-dialog",{attrs:{title:"设置跳转结果",visible:t.showDialog,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"banner-dialog"},[i("div",{staticClass:"banner-dialog-radio-group"},[i("el-radio",{attrs:{label:"product://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("商品")])],1),"product://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入商品名后选择添加")]):t._e(),"product://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.row.link,callback:function(e){t.$set(t.row,"link",e)},expression:"row.link"}},t._l(t.products,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e()])])],1)},U=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"preview"})])}],F={name:"Banner",data:function(){return{row:{},showDialog:!1,token:Object(p["e"])(),syncing:!1,products:[],list:[]}},mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.GetSlideShowList",Object(u["a"])("SlideShowListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),count:100}));case 2:return e=t.sent,i=e.slideshowlistList.filter(function(t){return t.link.startsWith("product://")}).map(function(t){return t.link.slice(10)}),t.next=6,Object(d["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:i,count:i.length,sortby:1,sort:1}));case 6:n=t.sent,e.slideshowlistList.forEach(function(t){return t.product=n.productlistList.find(function(e){return e.id==t.link.slice(10)})}),this.list=e.slideshowlistList;case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addImage:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i,n,r,o,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=new FileReader,n=e.raw,r="image/jpeg"===n.type||"image/png"===n.type,o=n.size/1024/1024<2,s=function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return a.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),t.abrupt("return");case 3:if(o){t.next=6;break}return a.$message.error("上传图片大小不能超过 2MB!"),t.abrupt("return");case 6:return a.syncing=!0,e=new FormData,e.append("file",n),t.next=11,fetch("https://file.sansanll.com",{method:"POST",body:e,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return"".concat(t.file)});case 11:return i=t.sent,t.next=14,Object(d["a"])("StoreSlideShowService.CreateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:a.token}),slideshow:Object(u["a"])("SlideShow",{image:i,toptime:parseInt(Date.now()/1e3)})}));case 14:s=t.sent,a.list.splice(0,0,s),a.syncing=!1;case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i.onload=function(t){var e=new Image;e.onload=function(){e.width,e.height;s()},e.src=t.target.result},i.readAsDataURL(n);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),editRow:function(t){t=JSON.parse(JSON.stringify(t)),t.linkprefix="",t.link.startsWith("product://")&&(t.linkprefix="product://",t.link=t.link.slice(10)),""==t.linkprefix&&(t.link=""),this.row=t,this.showDialog=!0},deleteRow:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.DeleteSlideShow",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:e.id}));case 2:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowTopTime:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=JSON.parse(JSON.stringify(e)),t.next=3,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{toptime:parseInt(Date.now()/1e3)}))}));case 3:i=t.sent,i.product=e.product,this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1),this.list.splice(0,0,i);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowLink:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.row.linkprefix&&this.row.link){t.next=3;break}return this.showDialog=!1,t.abrupt("return");case 3:return e=JSON.parse(JSON.stringify(this.row)),t.next=6,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{link:e.linkprefix+e.link}))}));case 6:if(i=t.sent,!i.link.startsWith("product://")){t.next=11;break}return t.next=10,Object(d["a"])("StoreProductService.GetProduct",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(10)}));case 10:i.product=t.sent;case 11:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1,i),this.showDialog=!1;case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(d["b"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})}}},A=F,B=(i("185e"),Object(k["a"])(A,E,U,!1,null,"99f3f97e",null)),M=B.exports,H=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container main"},[t._m(0),i("div",{staticClass:"upload-list"},[i("div",{staticStyle:{"font-size":"18px","line-height":"2.225",color:"#666",display:"flex","align-items":"center",width:"375px"}},[i("div",{staticStyle:{flex:"1"}},[t._v("\n          上传轮播图\n          "),i("i",{staticClass:"el-icon-loading",style:{display:t.syncing?"":"none"}})]),t.list.length<5?i("el-upload",{attrs:{"show-file-list":!1,"on-change":t.addImage,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("上传文件")])],1):t._e()],1),i("p",{staticStyle:{"font-size":"12px",color:"#ccc"}},[t._v("最多上传5张图片，最佳比例3:1")]),t._l(t.list,function(e,n){return i("div",{key:e,staticClass:"upload-item"},[i("div",{staticClass:"upload-item-image",style:{"background-image":"url("+e.image+")"}},[i("div",{staticClass:"upload-item-image-cover"},[e.product?t._e():i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"4px",color:"rgb(206, 55, 46)"}}),t._v("\n              暂未配置跳转，点击进行配置\n            ")]),e.product?i("span",{on:{click:function(i){t.editRow(e)}}},[i("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"4px",color:"rgb(104, 153, 110)"}}),t._v("\n              商品 "+t._s(e.product.name)+"\n            ")]):t._e()])]),i("div",{staticClass:"upload-item-op"},[i("el-tooltip",{attrs:{effect:"dark",content:"删除该图片",placement:"right"}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){t.deleteRow(e)}}})]),i("el-tooltip",{attrs:{effect:"dark",content:"置顶图片",placement:"right"}},[0!==n?i("i",{staticClass:"el-icon-caret-top",on:{click:function(i){t.updateRowTopTime(e)}}}):t._e()])],1)])})],2)]),i("el-dialog",{attrs:{title:"设置跳转结果",visible:t.showDialog,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"banner-dialog"},[i("div",{staticClass:"banner-dialog-radio-group"},[i("el-radio",{attrs:{label:"product://"},model:{value:t.row.linkprefix,callback:function(e){t.$set(t.row,"linkprefix",e)},expression:"row.linkprefix"}},[t._v("商品")])],1),"product://"==t.row.linkprefix?i("div",{staticClass:"banner-dialog-comment"},[t._v("请输入商品名后选择添加")]):t._e(),"product://"==t.row.linkprefix?i("div",[i("el-row",{attrs:{gutter:"8"}},[i("el-col",{attrs:{span:"16"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.row.link,callback:function(e){t.$set(t.row,"link",e)},expression:"row.link"}},t._l(t.products,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-col",{attrs:{span:"2"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRowLink}},[t._v("确认")])],1)],1)],1):t._e()])])],1)},K=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"preview"})])}],V={name:"Banner",data:function(){return{row:{},showDialog:!1,token:Object(p["e"])(),syncing:!1,products:[],list:[]}},mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.GetSlideShowList",Object(u["a"])("SlideShowListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),count:100}));case 2:return e=t.sent,i=e.slideshowlistList.filter(function(t){return t.link.startsWith("product://")}).map(function(t){return t.link.slice(10)}),t.next=6,Object(d["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),idlistList:i,count:i.length,sortby:1,sort:1}));case 6:n=t.sent,e.slideshowlistList.forEach(function(t){return t.product=n.productlistList.find(function(e){return e.id==t.link.slice(10)})}),this.list=e.slideshowlistList;case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addImage:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i,n,r,o,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=new FileReader,n=e.raw,r="image/jpeg"===n.type||"image/png"===n.type,o=n.size/1024/1024<2,s=function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return a.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),t.abrupt("return");case 3:if(o){t.next=6;break}return a.$message.error("上传图片大小不能超过 2MB!"),t.abrupt("return");case 6:return a.syncing=!0,e=new FormData,e.append("file",n),t.next=11,fetch("https://file.sansanll.com",{method:"POST",body:e,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return"".concat(t.file)});case 11:return i=t.sent,t.next=14,Object(d["a"])("StoreSlideShowService.CreateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:a.token}),slideshow:Object(u["a"])("SlideShow",{image:i,toptime:parseInt(Date.now()/1e3)})}));case 14:s=t.sent,a.list.splice(0,0,s),a.syncing=!1;case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i.onload=function(t){var e=new Image;e.onload=function(){e.width,e.height;s()},e.src=t.target.result},i.readAsDataURL(n);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),editRow:function(t){t=JSON.parse(JSON.stringify(t)),t.linkprefix="",t.link.startsWith("product://")&&(t.linkprefix="product://",t.link=t.link.slice(10)),""==t.linkprefix&&(t.link=""),this.row=t,this.showDialog=!0},deleteRow:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])("StoreSlideShowService.DeleteSlideShow",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:e.id}));case 2:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowTopTime:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=JSON.parse(JSON.stringify(e)),t.next=3,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{toptime:parseInt(Date.now()/1e3)}))}));case 3:i=t.sent,i.product=e.product,this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1),this.list.splice(0,0,i);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateRowLink:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.row.linkprefix&&this.row.link){t.next=3;break}return this.showDialog=!1,t.abrupt("return");case 3:return e=JSON.parse(JSON.stringify(this.row)),t.next=6,Object(d["a"])("StoreSlideShowService.UpdateSlideShow",Object(u["a"])("SlideShowWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),slideshow:Object(u["a"])("SlideShow",Object(c["a"])({},e,{link:e.linkprefix+e.link}))}));case 6:if(i=t.sent,!i.link.startsWith("product://")){t.next=11;break}return t.next=10,Object(d["a"])("StoreProductService.GetProduct",Object(u["a"])("IDWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),id:i.link.slice(10)}));case 10:i.product=t.sent;case 11:this.list.splice(this.list.findIndex(function(t){return t.id===e.id}),1,i),this.showDialog=!1;case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(d["b"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})}}},X=V,Y=(i("da13"),Object(k["a"])(X,H,K,!1,null,"eb1fc7c0",null)),Z=Y.exports,tt={_0:g,_1:x,_2:C,_3:q,_4:Q,_6:M,_7:Z},et={0:"_0",1:"_1",2:"_2",3:"_3",4:"_4",6:"_6",7:"_7"},it=Object(o["a"])({name:"marketing-detail-entry",components:tt,map:et}),nt=it,rt=Object(k["a"])(nt,n,r,!1,null,null,null);e["default"]=rt.exports},c212:function(t,e,i){},c70c:function(t,e,i){},da13:function(t,e,i){"use strict";var n=i("04af"),r=i.n(n);r.a},e0f2:function(t,e,i){},f559:function(t,e,i){"use strict";var n=i("5ca1"),r=i("9def"),o=i("d2c8"),s="startsWith",a=""[s];n(n.P+n.F*i("5147")(s),"String",{startsWith:function(t){var e=o(this,t,s),i=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return a?a.call(e,n,i):e.slice(i,i+n.length)===n}})},f87f:function(t,e,i){}}]);
//# sourceMappingURL=marketing-banner.42162f6c.js.map