(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["marketing-edit"],{"11a5":function(t,e,o){"use strict";var l=o("30fc"),r=o.n(l);r.a},1803:function(t,e,o){"use strict";var l=o("3a0d"),r=o.n(l);r.a},"30fc":function(t,e,o){},"3a0d":function(t,e,o){},"4d7b":function(t,e,o){"use strict";var l=o("8bec"),r=o.n(l);r.a},"69a4":function(t,e,o){},"6a28":function(t,e,o){"use strict";var l=o("69a4"),r=o.n(l);r.a},"80bf":function(t,e,o){"use strict";o("96cf");var l=o("1da1"),r=(o("7f7f"),o("a3fb"));e["a"]=function(t){var e=t.name,o=t.components,i=t.map;return{name:e,components:o,data:function(){return{store:{}}},created:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(r["b"])();case 2:this.store=t.sent;case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),render:function(t){return t(i[this.store.kind])}}}},"8bec":function(t,e,o){},"9d24":function(t,e,o){},b2e6:function(t,e,o){},b897:function(t,e,o){"use strict";var l=o("fabf"),r=o.n(l);r.a},c48d:function(t,e,o){"use strict";var l=o("b2e6"),r=o.n(l);r.a},c832:function(t,e,o){"use strict";var l=o("9d24"),r=o.n(l);r.a},f907:function(t,e,o){"use strict";o.r(e);var l,r,i=o("80bf"),a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ml-l pl-l mb-l pb-l"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1),o("el-form",{ref:"form",staticClass:"marketing-type-form",attrs:{"label-position":"left","label-width":"100px",size:"small"}},[o("div",{staticClass:"container"},[o("h3",{staticClass:"title"},[t._v("新建营销规则")]),o("el-form-item",{attrs:{label:"营销规则名称",prop:"name"}},[o("el-col",{attrs:{span:"8"}},[o("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("el-form-item",{attrs:{label:"营销类型",prop:"kind"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满减")])],1),1==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("减")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reduction,callback:function(e){t.$set(t.form,"reduction",e)},expression:"form.reduction"}},[o("template",{slot:"append"},[t._v("元")])],2)],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:20},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠优惠券")])],1),20==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{attrs:{span:"2"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n                "+t._s(t.currentGift.name||"选择优惠券模版")+"\n                "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:21},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠商品")])],1),21==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.currentGift.id,callback:function(e){t.$set(t.currentGift,"id",e)},expression:"currentGift.id"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"3"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("用户手动领券")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{span:"3"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n              "+t._s(t.currentGift.name||"选择优惠券模版")+"\n              "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{offset:"1",span:"6"}},[o("el-switch",{staticStyle:{"margin-top":"-3px"},attrs:{"inactive-value":0,"active-value":1},model:{value:t.form.newuser,callback:function(e){t.$set(t.form,"newuser",e)},expression:"form.newuser"}}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v("仅限新用户")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:3},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满免运费")])],1),3==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{offset:"1",span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"left","padding-left":"12px"},attrs:{span:"2"}},[t._v("免运费")])]:t._e()],2)],1),o("el-form-item",{attrs:{label:"有效时间"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"0"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("不限制")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"1"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("固定时段")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.limittime,expression:"limittime == 1"}],attrs:{span:"4"}},[o("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)],1)],1),1==t.form.kind||20==t.form.kind||21==t.form.kind||3==t.form.kind?o("el-form-item",{attrs:{label:"适用商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于所有商品")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于部分商品")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不作用于部分商品")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e(),0==t.form.kind&&0==t.form.newuser?o("el-form-item",{attrs:{label:"展示商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于所有商品页")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于部分商品页")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不展示于部分商品页")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e()],1)]),o("div",{staticClass:"container conponedit-button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建")])],1),o("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"优惠券模版",width:"1000px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("el-table",{attrs:{data:t.coupontemplatelist,border:"","row-key":"id"}},[o("el-table-column",{attrs:{label:"券名称",prop:"name"}}),o("el-table-column",{attrs:{label:"面值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.amountkind?o("div",[t._v(t._s(e.row.amountbegin/100+"元 ~ "+e.row.amountend/100+"元"))]):o("div",[t._v(t._s(e.row.amount/100)+"元")])]}}])}),o("el-table-column",{attrs:{label:"规则",prop:"rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v("满"+t._s(e.row.reach/100)+"可用")])]}}])}),o("el-table-column",{attrs:{label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.timekind?o("div",[t._v("不限制")]):t._e(),2===e.row.timekind?o("div",[t._v("发放或领取后"+t._s(e.row.duration/60/60/24)+"天")]):t._e()]}}])}),o("el-table-column",{attrs:{label:"生效范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.producttype?o("div",[t._v("可用于所有商品")]):t._e(),1===e.row.producttype?o("div",[t._v("可用于部分商品")]):t._e(),2===e.row.producttype?o("div",[t._v("不可用于部分商品")]):t._e()]}}])}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){t.chooseCoupon(e.row)}}},[t._v("选择")])]}}])})],1)],1)],1)},n=[],s=o("e8e1"),c=o("8e44"),d=o("73cd"),u={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-6048e5),t.$emit("pick",[o,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),t.$emit("pick",[o,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-7776e6),t.$emit("pick",[o,e])}}]},m={data:function(){return{products:[],pickerOptions:u,coupontemplatelist:[],dialogTableVisible:!1,form:{name:"",kind:1,newuser:0,reach:0,reduction:0,gifttype:0,giftid:0,producttype:0,productidsList:[],categorytype:0,categoryidsList:[]},limittime:"0",time:[],currentGift:{},fetchProductLoading:!1,token:""}},watch:{"form.kind":{handler:function(){this.currentGift={}}}},created:function(){var t=this;this.token=Object(d["e"])(),Object(c["a"])("StoreCouponTemplateService.GetCouponTemplateList",Object(s["a"])("CouponTemplateListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),isdeleted:2,count:100})).then(function(e){t.coupontemplatelist=e.coupontemplatelistList}),Object(c["a"])("StoreCategoryService.GetCategoryList",Object(s["a"])("CategoryListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),ishidden:2,level:2,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(c["b"])("StoreProductService.GetProductList",Object(s["a"])("ProductListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},chooseCoupon:function(t){this.currentGift=t,this.dialogTableVisible=!1},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));0==e.kind&&(e.gifttype=0,e.giftid=this.currentGift.id||0),20==e.kind&&(e.kind=2,e.gifttype=0,e.giftid=this.currentGift.id||0),21==e.kind&&(e.kind=2,e.gifttype=1,e.giftid=this.currentGift.id||0),1==this.limittime&&2===this.time.length&&(e.begintime=parseInt(this.time[0].getTime()/1e3),e.endtime=parseInt(this.time[1].getTime()/1e3)),e.reach=parseInt(100*e.reach),e.reduction=parseInt(100*e.reduction),Object(c["a"])("StoreMarketingService.CreateMarketing",Object(s["a"])("MarketingWithTokenRequest",{token:Object(s["a"])("Token",{token:this.token}),marketing:Object(s["a"])("Marketing",e)})).then(function(e){t.$router.back()})}}},p=m,f=(o("b897"),o("2877")),k=Object(f["a"])(p,a,n,!1,null,null,null),b=k.exports,v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ml-l pl-l mb-l pb-l"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1),o("el-form",{ref:"form",staticClass:"marketing-type-form",attrs:{"label-position":"left","label-width":"100px",size:"small"}},[o("div",{staticClass:"container"},[o("h3",{staticClass:"title"},[t._v("新建营销规则")]),o("el-form-item",{attrs:{label:"营销规则名称",prop:"name"}},[o("el-col",{attrs:{span:"8"}},[o("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("el-form-item",{attrs:{label:"营销类型",prop:"kind"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满减")])],1),1==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("减")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reduction,callback:function(e){t.$set(t.form,"reduction",e)},expression:"form.reduction"}},[o("template",{slot:"append"},[t._v("元")])],2)],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:20},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠优惠券")])],1),20==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{attrs:{span:"2"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n                "+t._s(t.currentGift.name||"选择优惠券模版")+"\n                "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:21},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠商品")])],1),21==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.currentGift.id,callback:function(e){t.$set(t.currentGift,"id",e)},expression:"currentGift.id"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"3"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("用户手动领券")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{span:"3"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n              "+t._s(t.currentGift.name||"选择优惠券模版")+"\n              "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{offset:"1",span:"6"}},[o("el-switch",{staticStyle:{"margin-top":"-3px"},attrs:{"inactive-value":0,"active-value":1},model:{value:t.form.newuser,callback:function(e){t.$set(t.form,"newuser",e)},expression:"form.newuser"}}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v("仅限新用户")])],1)],1)],1),o("el-form-item",{attrs:{label:"有效时间"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"0"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("不限制")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"1"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("固定时段")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.limittime,expression:"limittime == 1"}],attrs:{span:"4"}},[o("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)],1)],1),1==t.form.kind||20==t.form.kind||21==t.form.kind||3==t.form.kind?o("el-form-item",{attrs:{label:"适用商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于所有商品")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于部分商品")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不作用于部分商品")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e(),0==t.form.kind&&0==t.form.newuser?o("el-form-item",{attrs:{label:"展示商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于所有商品页")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于部分商品页")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不展示于部分商品页")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e()],1)]),o("div",{staticClass:"container conponedit-button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建")])],1),o("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"优惠券模版",width:"1000px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("el-table",{attrs:{data:t.coupontemplatelist,border:"","row-key":"id"}},[o("el-table-column",{attrs:{label:"券名称",prop:"name"}}),o("el-table-column",{attrs:{label:"面值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.amountkind?o("div",[t._v(t._s(e.row.amountbegin/100+"元 ~ "+e.row.amountend/100+"元"))]):o("div",[t._v(t._s(e.row.amount/100)+"元")])]}}])}),o("el-table-column",{attrs:{label:"规则",prop:"rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v("满"+t._s(e.row.reach/100)+"可用")])]}}])}),o("el-table-column",{attrs:{label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.timekind?o("div",[t._v("不限制")]):t._e(),2===e.row.timekind?o("div",[t._v("发放或领取后"+t._s(e.row.duration/60/60/24)+"天")]):t._e()]}}])}),o("el-table-column",{attrs:{label:"生效范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.producttype?o("div",[t._v("可用于所有商品")]):t._e(),1===e.row.producttype?o("div",[t._v("可用于部分商品")]):t._e(),2===e.row.producttype?o("div",[t._v("不可用于部分商品")]):t._e()]}}])}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){t.chooseCoupon(e.row)}}},[t._v("选择")])]}}])})],1)],1)],1)},h=[],_={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-6048e5),t.$emit("pick",[o,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),t.$emit("pick",[o,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-7776e6),t.$emit("pick",[o,e])}}]},g={data:function(){return{products:[],pickerOptions:_,coupontemplatelist:[],dialogTableVisible:!1,form:{name:"",kind:1,newuser:0,reach:0,reduction:0,gifttype:0,giftid:0,producttype:0,productidsList:[],categorytype:0,categoryidsList:[]},limittime:"0",time:[],currentGift:{},fetchProductLoading:!1,token:""}},watch:{"form.kind":{handler:function(){this.currentGift={}}}},created:function(){var t=this;this.token=Object(d["e"])(),Object(c["a"])("StoreCouponTemplateService.GetCouponTemplateList",Object(s["a"])("CouponTemplateListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),isdeleted:2,count:100})).then(function(e){t.coupontemplatelist=e.coupontemplatelistList}),Object(c["a"])("StoreCategoryService.GetCategoryList",Object(s["a"])("CategoryListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(c["b"])("StoreProductService.GetProductList",Object(s["a"])("ProductListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},chooseCoupon:function(t){this.currentGift=t,this.dialogTableVisible=!1},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));0==e.kind&&(e.gifttype=0,e.giftid=this.currentGift.id||0),20==e.kind&&(e.kind=2,e.gifttype=0,e.giftid=this.currentGift.id||0),21==e.kind&&(e.kind=2,e.gifttype=1,e.giftid=this.currentGift.id||0),1==this.limittime&&2===this.time.length&&(e.begintime=parseInt(this.time[0].getTime()/1e3),e.endtime=parseInt(this.time[1].getTime()/1e3)),e.reach=parseInt(100*e.reach),e.reduction=parseInt(100*e.reduction),Object(c["a"])("StoreMarketingService.CreateMarketing",Object(s["a"])("MarketingWithTokenRequest",{token:Object(s["a"])("Token",{token:this.token}),marketing:Object(s["a"])("Marketing",e)})).then(function(e){t.$router.back()})}}},y=g,w=(o("11a5"),Object(f["a"])(y,v,h,!1,null,null,null)),x=w.exports,S=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ml-l pl-l mb-l pb-l"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1),o("el-form",{ref:"form",staticClass:"marketing-type-form",attrs:{"label-position":"left","label-width":"100px",size:"small"}},[o("div",{staticClass:"container"},[o("h3",{staticClass:"title"},[t._v("新建营销规则")]),o("el-form-item",{attrs:{label:"营销规则名称",prop:"name"}},[o("el-col",{attrs:{span:"8"}},[o("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("el-form-item",{attrs:{label:"营销类型",prop:"kind"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满减")])],1),1==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("减")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reduction,callback:function(e){t.$set(t.form,"reduction",e)},expression:"form.reduction"}},[o("template",{slot:"append"},[t._v("元")])],2)],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:20},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠优惠券")])],1),20==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{attrs:{span:"2"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n                "+t._s(t.currentGift.name||"选择优惠券模版")+"\n                "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:21},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠商品")])],1),21==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.currentGift.id,callback:function(e){t.$set(t.currentGift,"id",e)},expression:"currentGift.id"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"3"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("用户手动领券")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{span:"3"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n              "+t._s(t.currentGift.name||"选择优惠券模版")+"\n              "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{offset:"1",span:"6"}},[o("el-switch",{staticStyle:{"margin-top":"-3px"},attrs:{"inactive-value":0,"active-value":1},model:{value:t.form.newuser,callback:function(e){t.$set(t.form,"newuser",e)},expression:"form.newuser"}}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v("仅限新用户")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:3},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满免运费")])],1),3==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{offset:"1",span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"left","padding-left":"12px"},attrs:{span:"2"}},[t._v("免运费")])]:t._e()],2)],1),o("el-form-item",{attrs:{label:"有效时间"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"0"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("不限制")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"1"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("固定时段")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.limittime,expression:"limittime == 1"}],attrs:{span:"4"}},[o("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)],1)],1),1==t.form.kind||20==t.form.kind||21==t.form.kind||3==t.form.kind?o("el-form-item",{attrs:{label:"适用商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于所有商品")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于部分商品")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不作用于部分商品")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e(),0==t.form.kind&&0==t.form.newuser?o("el-form-item",{attrs:{label:"展示商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于所有商品页")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于部分商品页")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不展示于部分商品页")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e()],1)]),o("div",{staticClass:"container conponedit-button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建")])],1),o("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"优惠券模版",width:"1000px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("el-table",{attrs:{data:t.coupontemplatelist,border:"","row-key":"id"}},[o("el-table-column",{attrs:{label:"券名称",prop:"name"}}),o("el-table-column",{attrs:{label:"面值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.amountkind?o("div",[t._v(t._s(e.row.amountbegin/100+"元 ~ "+e.row.amountend/100+"元"))]):o("div",[t._v(t._s(e.row.amount/100)+"元")])]}}])}),o("el-table-column",{attrs:{label:"规则",prop:"rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v("满"+t._s(e.row.reach/100)+"可用")])]}}])}),o("el-table-column",{attrs:{label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.timekind?o("div",[t._v("不限制")]):t._e(),2===e.row.timekind?o("div",[t._v("发放或领取后"+t._s(e.row.duration/60/60/24)+"天")]):t._e()]}}])}),o("el-table-column",{attrs:{label:"生效范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.producttype?o("div",[t._v("可用于所有商品")]):t._e(),1===e.row.producttype?o("div",[t._v("可用于部分商品")]):t._e(),2===e.row.producttype?o("div",[t._v("不可用于部分商品")]):t._e()]}}])}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){t.chooseCoupon(e.row)}}},[t._v("选择")])]}}])})],1)],1)],1)},L=[],$={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-6048e5),t.$emit("pick",[o,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),t.$emit("pick",[o,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-7776e6),t.$emit("pick",[o,e])}}]},T={data:function(){return{products:[],pickerOptions:$,coupontemplatelist:[],dialogTableVisible:!1,form:{name:"",kind:1,newuser:0,reach:0,reduction:0,gifttype:0,giftid:0,producttype:0,productidsList:[],categorytype:0,categoryidsList:[]},limittime:"0",time:[],currentGift:{},fetchProductLoading:!1,token:""}},watch:{"form.kind":{handler:function(){this.currentGift={}}}},created:function(){var t=this;this.token=Object(d["e"])(),Object(c["a"])("StoreCouponTemplateService.GetCouponTemplateList",Object(s["a"])("CouponTemplateListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),isdeleted:2,count:100})).then(function(e){t.coupontemplatelist=e.coupontemplatelistList}),Object(c["a"])("StoreCategoryService.GetCategoryList",Object(s["a"])("CategoryListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),ishidden:2,level:2,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(c["b"])("StoreProductService.GetProductList",Object(s["a"])("ProductListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},chooseCoupon:function(t){this.currentGift=t,this.dialogTableVisible=!1},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));0==e.kind&&(e.gifttype=0,e.giftid=this.currentGift.id||0),20==e.kind&&(e.kind=2,e.gifttype=0,e.giftid=this.currentGift.id||0),21==e.kind&&(e.kind=2,e.gifttype=1,e.giftid=this.currentGift.id||0),1==this.limittime&&2===this.time.length&&(e.begintime=parseInt(this.time[0].getTime()/1e3),e.endtime=parseInt(this.time[1].getTime()/1e3)),e.reach=parseInt(100*e.reach),e.reduction=parseInt(100*e.reduction),Object(c["a"])("StoreMarketingService.CreateMarketing",Object(s["a"])("MarketingWithTokenRequest",{token:Object(s["a"])("Token",{token:this.token}),marketing:Object(s["a"])("Marketing",e)})).then(function(e){t.$router.back()})}}},C=T,O=(o("c832"),Object(f["a"])(C,S,L,!1,null,null,null)),P=O.exports,j=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ml-l pl-l mb-l pb-l"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1),o("el-form",{ref:"form",staticClass:"marketing-type-form",attrs:{"label-position":"left","label-width":"100px",size:"small"}},[o("div",{staticClass:"container"},[o("h3",{staticClass:"title"},[t._v("新建营销规则")]),o("el-form-item",{attrs:{label:"营销规则名称",prop:"name"}},[o("el-col",{attrs:{span:"8"}},[o("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("el-form-item",{attrs:{label:"营销类型",prop:"kind"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满减")])],1),1==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("减")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reduction,callback:function(e){t.$set(t.form,"reduction",e)},expression:"form.reduction"}},[o("template",{slot:"append"},[t._v("元")])],2)],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:20},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠优惠券")])],1),20==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{attrs:{span:"2"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n                "+t._s(t.currentGift.name||"选择优惠券模版")+"\n                "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:21},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠商品")])],1),21==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.currentGift.id,callback:function(e){t.$set(t.currentGift,"id",e)},expression:"currentGift.id"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"3"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("用户手动领券")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{span:"3"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n              "+t._s(t.currentGift.name||"选择优惠券模版")+"\n              "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{offset:"1",span:"6"}},[o("el-switch",{staticStyle:{"margin-top":"-3px"},attrs:{"inactive-value":0,"active-value":1},model:{value:t.form.newuser,callback:function(e){t.$set(t.form,"newuser",e)},expression:"form.newuser"}}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v("仅限新用户")])],1)],1)],1),o("el-form-item",{attrs:{label:"有效时间"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"0"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("不限制")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"1"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("固定时段")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.limittime,expression:"limittime == 1"}],attrs:{span:"4"}},[o("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)],1)],1),1==t.form.kind||20==t.form.kind||21==t.form.kind||3==t.form.kind?o("el-form-item",{attrs:{label:"适用商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于所有商品")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于部分商品")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不作用于部分商品")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e(),0==t.form.kind&&0==t.form.newuser?o("el-form-item",{attrs:{label:"展示商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于所有商品页")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于部分商品页")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不展示于部分商品页")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e()],1)]),o("div",{staticClass:"container conponedit-button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建")])],1),o("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"优惠券模版",width:"1000px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("el-table",{attrs:{data:t.coupontemplatelist,border:"","row-key":"id"}},[o("el-table-column",{attrs:{label:"券名称",prop:"name"}}),o("el-table-column",{attrs:{label:"面值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.amountkind?o("div",[t._v(t._s(e.row.amountbegin/100+"元 ~ "+e.row.amountend/100+"元"))]):o("div",[t._v(t._s(e.row.amount/100)+"元")])]}}])}),o("el-table-column",{attrs:{label:"规则",prop:"rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v("满"+t._s(e.row.reach/100)+"可用")])]}}])}),o("el-table-column",{attrs:{label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.timekind?o("div",[t._v("不限制")]):t._e(),2===e.row.timekind?o("div",[t._v("发放或领取后"+t._s(e.row.duration/60/60/24)+"天")]):t._e()]}}])}),o("el-table-column",{attrs:{label:"生效范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.producttype?o("div",[t._v("可用于所有商品")]):t._e(),1===e.row.producttype?o("div",[t._v("可用于部分商品")]):t._e(),2===e.row.producttype?o("div",[t._v("不可用于部分商品")]):t._e()]}}])}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){t.chooseCoupon(e.row)}}},[t._v("选择")])]}}])})],1)],1)],1)},G=[],D={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-6048e5),t.$emit("pick",[o,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),t.$emit("pick",[o,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-7776e6),t.$emit("pick",[o,e])}}]},V={data:function(){return{products:[],pickerOptions:D,coupontemplatelist:[],dialogTableVisible:!1,form:{name:"",kind:1,newuser:0,reach:0,reduction:0,gifttype:0,giftid:0,producttype:0,productidsList:[],categorytype:0,categoryidsList:[]},limittime:"0",time:[],currentGift:{},fetchProductLoading:!1,token:""}},watch:{"form.kind":{handler:function(){this.currentGift={}}}},created:function(){var t=this;this.token=Object(d["e"])(),Object(c["a"])("StoreCouponTemplateService.GetCouponTemplateList",Object(s["a"])("CouponTemplateListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),isdeleted:2,count:100})).then(function(e){t.coupontemplatelist=e.coupontemplatelistList}),Object(c["a"])("StoreCategoryService.GetCategoryList",Object(s["a"])("CategoryListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(c["b"])("StoreProductService.GetProductList",Object(s["a"])("ProductListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},chooseCoupon:function(t){this.currentGift=t,this.dialogTableVisible=!1},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));0==e.kind&&(e.gifttype=0,e.giftid=this.currentGift.id||0),20==e.kind&&(e.kind=2,e.gifttype=0,e.giftid=this.currentGift.id||0),21==e.kind&&(e.kind=2,e.gifttype=1,e.giftid=this.currentGift.id||0),1==this.limittime&&2===this.time.length&&(e.begintime=parseInt(this.time[0].getTime()/1e3),e.endtime=parseInt(this.time[1].getTime()/1e3)),e.reach=parseInt(100*e.reach),e.reduction=parseInt(100*e.reduction),Object(c["a"])("StoreMarketingService.CreateMarketing",Object(s["a"])("MarketingWithTokenRequest",{token:Object(s["a"])("Token",{token:this.token}),marketing:Object(s["a"])("Marketing",e)})).then(function(e){t.$router.back()})}}},z=V,N=(o("c48d"),Object(f["a"])(z,j,G,!1,null,null,null)),R=N.exports,q=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ml-l pl-l mb-l pb-l"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1),o("el-form",{ref:"form",staticClass:"marketing-type-form",attrs:{"label-position":"left","label-width":"100px",size:"small"}},[o("div",{staticClass:"container"},[o("h3",{staticClass:"title"},[t._v("新建营销规则")]),o("el-form-item",{attrs:{label:"营销规则名称",prop:"name"}},[o("el-col",{attrs:{span:"8"}},[o("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("el-form-item",{attrs:{label:"营销类型",prop:"kind"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满减")])],1),1==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("减")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reduction,callback:function(e){t.$set(t.form,"reduction",e)},expression:"form.reduction"}},[o("template",{slot:"append"},[t._v("元")])],2)],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:20},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠优惠券")])],1),20==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{attrs:{span:"2"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n                "+t._s(t.currentGift.name||"选择优惠券模版")+"\n                "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:21},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠商品")])],1),21==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.currentGift.id,callback:function(e){t.$set(t.currentGift,"id",e)},expression:"currentGift.id"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"3"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("用户手动领券")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{span:"3"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n              "+t._s(t.currentGift.name||"选择优惠券模版")+"\n              "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{offset:"1",span:"6"}},[o("el-switch",{staticStyle:{"margin-top":"-3px"},attrs:{"inactive-value":0,"active-value":1},model:{value:t.form.newuser,callback:function(e){t.$set(t.form,"newuser",e)},expression:"form.newuser"}}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v("仅限新用户")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:3},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满免运费")])],1),3==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{offset:"1",span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"left","padding-left":"12px"},attrs:{span:"2"}},[t._v("免运费")])]:t._e()],2)],1),o("el-form-item",{attrs:{label:"有效时间"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"0"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("不限制")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"1"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("固定时段")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.limittime,expression:"limittime == 1"}],attrs:{span:"4"}},[o("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)],1)],1),1==t.form.kind||20==t.form.kind||21==t.form.kind||3==t.form.kind?o("el-form-item",{attrs:{label:"适用商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于所有商品")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于部分商品")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不作用于部分商品")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e(),0==t.form.kind&&0==t.form.newuser?o("el-form-item",{attrs:{label:"展示商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于所有商品页")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("展示于部分商品页")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不展示于部分商品页")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e()],1)]),o("div",{staticClass:"container conponedit-button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建")])],1),o("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"优惠券模版",width:"1000px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("el-table",{attrs:{data:t.coupontemplatelist,border:"","row-key":"id"}},[o("el-table-column",{attrs:{label:"券名称",prop:"name"}}),o("el-table-column",{attrs:{label:"面值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.amountkind?o("div",[t._v(t._s(e.row.amountbegin/100+"元 ~ "+e.row.amountend/100+"元"))]):o("div",[t._v(t._s(e.row.amount/100)+"元")])]}}])}),o("el-table-column",{attrs:{label:"规则",prop:"rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v("满"+t._s(e.row.reach/100)+"可用")])]}}])}),o("el-table-column",{attrs:{label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.timekind?o("div",[t._v("不限制")]):t._e(),2===e.row.timekind?o("div",[t._v("发放或领取后"+t._s(e.row.duration/60/60/24)+"天")]):t._e()]}}])}),o("el-table-column",{attrs:{label:"生效范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.producttype?o("div",[t._v("可用于所有商品")]):t._e(),1===e.row.producttype?o("div",[t._v("可用于部分商品")]):t._e(),2===e.row.producttype?o("div",[t._v("不可用于部分商品")]):t._e()]}}])}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){t.chooseCoupon(e.row)}}},[t._v("选择")])]}}])})],1)],1)],1)},I=[],M={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-6048e5),t.$emit("pick",[o,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),t.$emit("pick",[o,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-7776e6),t.$emit("pick",[o,e])}}]},Q={data:function(){return{products:[],pickerOptions:M,coupontemplatelist:[],dialogTableVisible:!1,form:{name:"",kind:1,newuser:0,reach:0,reduction:0,gifttype:0,giftid:0,producttype:0,productidsList:[],categorytype:0,categoryidsList:[]},limittime:"0",time:[],currentGift:{},fetchProductLoading:!1,token:""}},watch:{"form.kind":{handler:function(){this.currentGift={}}}},created:function(){var t=this;this.token=Object(d["e"])(),Object(c["a"])("StoreCouponTemplateService.GetCouponTemplateList",Object(s["a"])("CouponTemplateListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),isdeleted:2,count:100})).then(function(e){t.coupontemplatelist=e.coupontemplatelistList}),Object(c["a"])("StoreCategoryService.GetCategoryList",Object(s["a"])("CategoryListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),ishidden:2,level:2,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(c["b"])("StoreProductService.GetProductList",Object(s["a"])("ProductListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},chooseCoupon:function(t){this.currentGift=t,this.dialogTableVisible=!1},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));0==e.kind&&(e.gifttype=0,e.giftid=this.currentGift.id||0),20==e.kind&&(e.kind=2,e.gifttype=0,e.giftid=this.currentGift.id||0),21==e.kind&&(e.kind=2,e.gifttype=1,e.giftid=this.currentGift.id||0),1==this.limittime&&2===this.time.length&&(e.begintime=parseInt(this.time[0].getTime()/1e3),e.endtime=parseInt(this.time[1].getTime()/1e3)),e.reach=parseInt(100*e.reach),e.reduction=parseInt(100*e.reduction),Object(c["a"])("StoreMarketingService.CreateMarketing",Object(s["a"])("MarketingWithTokenRequest",{token:Object(s["a"])("Token",{token:this.token}),marketing:Object(s["a"])("Marketing",e)})).then(function(e){t.$router.back()})}}},J=Q,E=(o("6a28"),Object(f["a"])(J,q,I,!1,null,null,null)),W=E.exports,A=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ml-l pl-l mb-l pb-l"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1),o("el-form",{ref:"form",staticClass:"marketing-type-form",attrs:{"label-position":"left","label-width":"100px",size:"small"}},[o("div",{staticClass:"container"},[o("h3",{staticClass:"title"},[t._v("新建营销规则")]),o("el-form-item",{attrs:{label:"营销规则名称",prop:"name"}},[o("el-col",{attrs:{span:"8"}},[o("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("el-form-item",{attrs:{label:"营销类型",prop:"kind"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满减")])],1),1==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("减")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reduction,callback:function(e){t.$set(t.form,"reduction",e)},expression:"form.reduction"}},[o("template",{slot:"append"},[t._v("元")])],2)],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:20},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠优惠券")])],1),20==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{attrs:{span:"2"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n                "+t._s(t.currentGift.name||"选择优惠券模版")+"\n                "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:21},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠商品")])],1),21==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.currentGift.id,callback:function(e){t.$set(t.currentGift,"id",e)},expression:"currentGift.id"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"3"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("用户手动领券")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{span:"3"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n              "+t._s(t.currentGift.name||"选择优惠券模版")+"\n              "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{offset:"1",span:"6"}},[o("el-switch",{staticStyle:{"margin-top":"-3px"},attrs:{"inactive-value":0,"active-value":1},model:{value:t.form.newuser,callback:function(e){t.$set(t.form,"newuser",e)},expression:"form.newuser"}}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v("仅限新用户")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:3},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满免运费")])],1),3==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{offset:"1",span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"left","padding-left":"12px"},attrs:{span:"2"}},[t._v("免运费")])]:t._e()],2)],1),o("el-form-item",{attrs:{label:"有效时间"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"0"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("不限制")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"1"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("固定时段")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.limittime,expression:"limittime == 1"}],attrs:{span:"4"}},[o("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)],1)],1),1==t.form.kind||20==t.form.kind||21==t.form.kind||3==t.form.kind?o("el-form-item",{attrs:{label:"适用商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于所有商品")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于部分商品")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不作用于部分商品")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e()],1)]),o("div",{staticClass:"container conponedit-button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建")])],1),o("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"优惠券模版",width:"1000px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("el-table",{attrs:{data:t.coupontemplatelist,border:"","row-key":"id"}},[o("el-table-column",{attrs:{label:"券名称",prop:"name"}}),o("el-table-column",{attrs:{label:"面值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.amountkind?o("div",[t._v(t._s(e.row.amountbegin/100+"元 ~ "+e.row.amountend/100+"元"))]):o("div",[t._v(t._s(e.row.amount/100)+"元")])]}}])}),o("el-table-column",{attrs:{label:"规则",prop:"rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v("满"+t._s(e.row.reach/100)+"可用")])]}}])}),o("el-table-column",{attrs:{label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.timekind?o("div",[t._v("不限制")]):t._e(),2===e.row.timekind?o("div",[t._v("发放或领取后"+t._s(e.row.duration/60/60/24)+"天")]):t._e()]}}])}),o("el-table-column",{attrs:{label:"生效范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.producttype?o("div",[t._v("可用于所有商品")]):t._e(),1===e.row.producttype?o("div",[t._v("可用于部分商品")]):t._e(),2===e.row.producttype?o("div",[t._v("不可用于部分商品")]):t._e()]}}])}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){t.chooseCoupon(e.row)}}},[t._v("选择")])]}}])})],1)],1)],1)},B=[],F={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-6048e5),t.$emit("pick",[o,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),t.$emit("pick",[o,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-7776e6),t.$emit("pick",[o,e])}}]},H={data:function(){return{products:[],pickerOptions:F,coupontemplatelist:[],dialogTableVisible:!1,form:{name:"",kind:1,newuser:0,reach:0,reduction:0,gifttype:0,giftid:0,producttype:0,productidsList:[],categorytype:0,categoryidsList:[]},limittime:"0",time:[],currentGift:{},fetchProductLoading:!1,token:""}},watch:{"form.kind":{handler:function(){this.currentGift={}}}},created:function(){var t=this;this.token=Object(d["e"])(),Object(c["a"])("StoreCouponTemplateService.GetCouponTemplateList",Object(s["a"])("CouponTemplateListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),isdeleted:2,count:100})).then(function(e){t.coupontemplatelist=e.coupontemplatelistList}),Object(c["a"])("StoreCategoryService.GetCategoryList",Object(s["a"])("CategoryListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(c["b"])("StoreProductService.GetProductList",Object(s["a"])("ProductListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},chooseCoupon:function(t){this.currentGift=t,this.dialogTableVisible=!1},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));0==e.kind&&(e.gifttype=0,e.giftid=this.currentGift.id||0),20==e.kind&&(e.kind=2,e.gifttype=0,e.giftid=this.currentGift.id||0),21==e.kind&&(e.kind=2,e.gifttype=1,e.giftid=this.currentGift.id||0),1==this.limittime&&2===this.time.length&&(e.begintime=parseInt(this.time[0].getTime()/1e3),e.endtime=parseInt(this.time[1].getTime()/1e3)),e.reach=parseInt(100*e.reach),e.reduction=parseInt(100*e.reduction),Object(c["a"])("StoreMarketingService.CreateMarketing",Object(s["a"])("MarketingWithTokenRequest",{token:Object(s["a"])("Token",{token:this.token}),marketing:Object(s["a"])("Marketing",e)})).then(function(e){t.$router.back()})}}},K=H,U=(o("4d7b"),Object(f["a"])(K,A,B,!1,null,null,null)),X=U.exports,Y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ml-l pl-l mb-l pb-l"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1),o("el-form",{ref:"form",staticClass:"marketing-type-form",attrs:{"label-position":"left","label-width":"100px",size:"small"}},[o("div",{staticClass:"container"},[o("h3",{staticClass:"title"},[t._v("新建营销规则")]),o("el-form-item",{attrs:{label:"营销规则名称",prop:"name"}},[o("el-col",{attrs:{span:"8"}},[o("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("el-form-item",{attrs:{label:"营销类型",prop:"kind"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满减")])],1),1==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("减")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reduction,callback:function(e){t.$set(t.form,"reduction",e)},expression:"form.reduction"}},[o("template",{slot:"append"},[t._v("元")])],2)],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:20},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠优惠券")])],1),20==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{attrs:{span:"2"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n                "+t._s(t.currentGift.name||"选择优惠券模版")+"\n                "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:21},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("满赠商品")])],1),21==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"1"}},[t._v("赠")]),o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",loading:t.fetchProductLoading,"remote-method":t.getProducts,placeholder:"搜索商品"},model:{value:t.currentGift.id,callback:function(e){t.$set(t.currentGift,"id",e)},expression:"currentGift.id"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"3"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("用户手动领券")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{span:"3"}},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("\n              "+t._s(t.currentGift.name||"选择优惠券模版")+"\n              "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.form.kind,expression:"form.kind == 0"}],attrs:{offset:"1",span:"6"}},[o("el-switch",{staticStyle:{"margin-top":"-3px"},attrs:{"inactive-value":0,"active-value":1},model:{value:t.form.newuser,callback:function(e){t.$set(t.form,"newuser",e)},expression:"form.newuser"}}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v("仅限新用户")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:3},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},[t._v("订单满免运费")])],1),3==t.form.kind?[o("el-col",{staticStyle:{"text-align":"center"},attrs:{offset:"1",span:"1"}},[t._v("满")]),o("el-col",{attrs:{span:"2"}},[o("el-input",{model:{value:t.form.reach,callback:function(e){t.$set(t.form,"reach",e)},expression:"form.reach"}},[o("template",{slot:"append"},[t._v("元")])],2)],1),o("el-col",{staticStyle:{"text-align":"left","padding-left":"12px"},attrs:{span:"2"}},[t._v("免运费")])]:t._e()],2)],1),o("el-form-item",{attrs:{label:"有效时间"}},[o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"0"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("不限制")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"2"}},[o("el-radio",{attrs:{label:"1"},model:{value:t.limittime,callback:function(e){t.limittime=e},expression:"limittime"}},[t._v("固定时段")])],1),o("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.limittime,expression:"limittime == 1"}],attrs:{span:"4"}},[o("el-date-picker",{attrs:{"picker-options":t.pickerOptions,"end-placeholder":"结束日期","range-separator":"至","start-placeholder":"开始日期",type:"daterange"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)],1)],1),1==t.form.kind||20==t.form.kind||21==t.form.kind||3==t.form.kind?o("el-form-item",{attrs:{label:"适用商品"}},[o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:0},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于所有商品")])],1)],1),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("作用于部分商品")])],1),1==t.form.producttype?[o("el-col",{staticClass:"product-select",attrs:{span:"4"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2),o("el-row",[o("el-col",{attrs:{span:"4"}},[o("el-radio",{attrs:{label:2},model:{value:t.form.producttype,callback:function(e){t.$set(t.form,"producttype",e)},expression:"form.producttype"}},[t._v("不作用于部分商品")])],1),"2"==t.form.producttype?[o("el-col",{attrs:{span:"4"}},[o("el-select",{attrs:{loading:t.fetchProductLoading,"remote-method":t.getProducts,filterable:"",multiple:"",placeholder:"搜索商品",remote:""},model:{value:t.form.productidsList,callback:function(e){t.$set(t.form,"productidsList",e)},expression:"form.productidsList"}},t._l(t.products,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]:t._e()],2)],1):t._e()],1)]),o("div",{staticClass:"container conponedit-button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建")])],1),o("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"优惠券模版",width:"1000px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("el-table",{attrs:{data:t.coupontemplatelist,border:"","row-key":"id"}},[o("el-table-column",{attrs:{label:"券名称",prop:"name"}}),o("el-table-column",{attrs:{label:"面值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.amountkind?o("div",[t._v(t._s(e.row.amountbegin/100+"元 ~ "+e.row.amountend/100+"元"))]):o("div",[t._v(t._s(e.row.amount/100)+"元")])]}}])}),o("el-table-column",{attrs:{label:"规则",prop:"rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v("满"+t._s(e.row.reach/100)+"可用")])]}}])}),o("el-table-column",{attrs:{label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.timekind?o("div",[t._v("不限制")]):t._e(),2===e.row.timekind?o("div",[t._v("发放或领取后"+t._s(e.row.duration/60/60/24)+"天")]):t._e()]}}])}),o("el-table-column",{attrs:{label:"生效范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.producttype?o("div",[t._v("可用于所有商品")]):t._e(),1===e.row.producttype?o("div",[t._v("可用于部分商品")]):t._e(),2===e.row.producttype?o("div",[t._v("不可用于部分商品")]):t._e()]}}])}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){t.chooseCoupon(e.row)}}},[t._v("选择")])]}}])})],1)],1)],1)},Z=[],tt={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-6048e5),t.$emit("pick",[o,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),t.$emit("pick",[o,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,o=new Date;o.setTime(o.getTime()-7776e6),t.$emit("pick",[o,e])}}]},et={data:function(){return{products:[],pickerOptions:tt,coupontemplatelist:[],dialogTableVisible:!1,form:{name:"",kind:1,newuser:0,reach:0,reduction:0,gifttype:0,giftid:0,producttype:0,productidsList:[],categorytype:0,categoryidsList:[]},limittime:"0",time:[],currentGift:{},fetchProductLoading:!1,token:""}},watch:{"form.kind":{handler:function(){this.currentGift={}}}},created:function(){var t=this;this.token=Object(d["e"])(),Object(c["a"])("StoreCouponTemplateService.GetCouponTemplateList",Object(s["a"])("CouponTemplateListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),isdeleted:2,count:100})).then(function(e){t.coupontemplatelist=e.coupontemplatelistList}),Object(c["a"])("StoreCategoryService.GetCategoryList",Object(s["a"])("CategoryListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{getProducts:function(t){var e=this;if(!t)return this.products=[];this.fetchProductLoading=!0,Object(c["b"])("StoreProductService.GetProductList",Object(s["a"])("ProductListQueryRequest",{token:Object(s["a"])("Token",{token:this.token}),name:t,isonline:1,sortby:1,sort:1,count:100})).then(function(t){e.products=t.productlistList,e.fetchProductLoading=!1})},chooseCoupon:function(t){this.currentGift=t,this.dialogTableVisible=!1},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));0==e.kind&&(e.gifttype=0,e.giftid=this.currentGift.id||0),20==e.kind&&(e.kind=2,e.gifttype=0,e.giftid=this.currentGift.id||0),21==e.kind&&(e.kind=2,e.gifttype=1,e.giftid=this.currentGift.id||0),1==this.limittime&&2===this.time.length&&(e.begintime=parseInt(this.time[0].getTime()/1e3),e.endtime=parseInt(this.time[1].getTime()/1e3)),e.reach=parseInt(100*e.reach),e.reduction=parseInt(100*e.reduction),Object(c["a"])("StoreMarketingService.CreateMarketing",Object(s["a"])("MarketingWithTokenRequest",{token:Object(s["a"])("Token",{token:this.token}),marketing:Object(s["a"])("Marketing",e)})).then(function(e){t.$router.back()})}}},ot=et,lt=(o("1803"),Object(f["a"])(ot,Y,Z,!1,null,null,null)),rt=lt.exports,it={_0:b,_1:x,_2:P,_3:R,_4:W,_6:X,_7:rt},at={0:"_0",1:"_1",2:"_2",3:"_3",4:"_4",6:"_6",7:"_7"},nt=Object(i["a"])({name:"marketing-edit-entry",components:it,map:at}),st=nt,ct=Object(f["a"])(st,l,r,!1,null,null,null);e["default"]=ct.exports},fabf:function(t,e,o){}}]);
//# sourceMappingURL=marketing-edit.1ebd5dd8.js.map