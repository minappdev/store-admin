(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["products-list"],{1733:function(t,e,i){},2061:function(t,e,i){},"20d6":function(t,e,i){"use strict";var s=i("5ca1"),o=i("0a49")(6),n="findIndex",r=!0;n in[]&&Array(1)[n](function(){r=!1}),s(s.P+s.F*r,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(n)},"26d3":function(t,e,i){},5583:function(t,e,i){},"56ee":function(t,e,i){"use strict";var s=i("bff6"),o=i.n(s);o.a},"5df3":function(t,e,i){"use strict";var s=i("02f4")(!0);i("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=s(e,i),this._i+=t.length,{value:t,done:!1})})},"5fcd":function(t,e,i){"use strict";var s=i("76a8"),o=i.n(s);o.a},6040:function(t,e,i){},"76a8":function(t,e,i){},"80bf":function(t,e,i){"use strict";i("96cf");var s=i("1da1"),o=(i("7f7f"),i("a3fb"));e["a"]=function(t){var e=t.name,i=t.components,n=t.map;return{name:e,components:i,data:function(){return{store:{}}},created:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["b"])();case 2:this.store=t.sent;case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),render:function(t){return t(n[this.store.kind])}}}},a105:function(t,e,i){"use strict";var s=i("2061"),o=i.n(s);o.a},ab1c:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tab"},t._l(t.data,function(e){return i("div",{key:e.label,class:["tab-item",{active:t.value===e.value}],on:{click:function(i){t.onClickItem(e.value)}}},[t._v(t._s(e.label))])}))},o=[],n={props:{data:{type:Array,default:function(){return[{label:"test",value:0},{label:"test2",value:1}]},required:!0},value:{default:"",required:!0}},methods:{onClickItem:function(t){this.$emit("input",t)}}},r=n,a=(i("56ee"),i("2877")),c=Object(a["a"])(r,s,o,!1,null,"5e44c4ee",null);e["a"]=c.exports},b954:function(t,e,i){"use strict";var s=i("f882"),o=i.n(s);o.a},bff6:function(t,e,i){},ddac:function(t,e,i){"use strict";i.r(e);var s,o,n=i("80bf"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container fr-aic fr-jcsb"},[i("comp-tab",{attrs:{data:[{label:"售卖中",value:1},{label:"已售罄",value:2},{label:"仓库中",value:3}]},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}}),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.$router.push({name:"products-edit"})}}},[t._v("发布商品")])],1),i("div",{staticClass:"container"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"商品ID"}},[i("el-input",{attrs:{placeholder:"请输入商品ID"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1),i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),i("el-form-item",{attrs:{label:"商品编码"}},[i("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.params.number,callback:function(e){t.$set(t.params,"number",e)},expression:"params.number"}})],1),i("el-form-item",{attrs:{label:"请选择商品分组"}},[i("el-select",{attrs:{placeholder:"选择商品分组"},model:{value:t.params.categoryid,callback:function(e){t.$set(t.params,"categoryid",e)},expression:"params.categoryid"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name.slice(1).split("/")[0]+" - "+t.name.slice(1).split("/")[1],value:t.id}})}))],1)],1),i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params,size:"mini"}},[i("el-form-item",{attrs:{label:"销量区间"}},[i("el-input",{attrs:{placeholder:"最低销量"},model:{value:t.params.salesvolumegreaterthan,callback:function(e){t.$set(t.params,"salesvolumegreaterthan",e)},expression:"params.salesvolumegreaterthan"}})],1),i("el-form-item",[t._v("-")]),i("el-form-item",[i("el-input",{attrs:{placeholder:"最高销量"},model:{value:t.params.salesvolumelessthan,callback:function(e){t.$set(t.params,"salesvolumelessthan",e)},expression:"params.salesvolumelessthan"}})],1)],1),i("el-button",{attrs:{size:"small"},on:{click:t.onSearch}},[t._v("筛选")]),i("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),i("div",{staticClass:"container"},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{staticClass:"table-column",attrs:{align:"center","header-align":"center",width:"46px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{attrs:{content:0!==e.row.toptime?"取消在首页展示该商品":"推荐该商品在首页展示(小程序显示:最后推荐的在最上面)",effect:"dark",placement:"top-start"}},[i("i",{class:["el-icon-star-on",{show:e.row.toptime>0}],style:{color:0!==e.row.toptime?"#e87b26":"grey"},on:{click:function(i){t.onClickRecommend(e.row)}}})])]}}])}),i("el-table-column",{attrs:{align:"center","header-align":"center",type:"selection",width:"40px"}}),i("el-table-column",{attrs:{align:"center","header-align":"center",label:"ID",prop:"id",width:"80px"}}),i("el-table-column",{attrs:{label:"商品",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-info_img"},[i("comp-imger",{attrs:{src:e.row.imagesList.length?e.row.imagesList[0]:""}})],1),i("div",{staticClass:"order-info_base"},[i("div",[i("span",{staticStyle:{cursor:"pointer",color:"#5c92c5"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v(t._s(e.row.name))]),i("div",{staticClass:"color3",staticStyle:{"font-size":"14px"}},[t._v("¥ "+t._s(t.minPrice(e.row)/100))])])])])]}}])}),i("el-table-column",{attrs:{label:"库存",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(null!==t.minQuantity(e.row)?t.minQuantity(e.row):"/")+"\n        ")]}}])}),i("el-table-column",{attrs:{label:"总销量",prop:"salesvolume",sortable:""}}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(new Date(1e3*e.row.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n        ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v("编辑")]),1===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOffline(e.row)}}},[t._v("下架")]):t._e(),0===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOnline(e.row)}}},[t._v("上架")]):t._e()]}}])})],1),i("div",{staticClass:"table-bottom"},[i("div",{staticClass:"mutil-action"},[i("el-button",{attrs:{size:"small",type:"text"},on:{click:t.onClickAllItem}},[t._v("全选")]),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!t.selectTable.length,size:"small",type:"text"},on:{click:t.onBatchOffline}},[t._v("批量下架")]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.onBatchCategory}},[i("el-button",{attrs:{disabled:!t.selectTable.length,size:"small",type:"text"}},[t._v("\n            批量改分组\n            "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticStyle:{height:"200px",overflow:"auto"}},t._l(t.categories,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:""+e.id}},[t._v(t._s(e.name.slice(1).split("/")[0]+" - "+e.name.slice(1).split("/")[1]))])}))])],1)],1),t.hasMore?i("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getProducts}},[t._v("加载更多")]):i("span",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1)],1)])},a=[],c=(i("ac4d"),i("8a81"),i("ac6a"),i("5df3"),i("20d6"),i("be94")),l=i("ab1c"),u=i("e8e1"),p=i("8e44"),d=i("73cd"),m={components:{"comp-tab":l["a"]},data:function(){return{status:1,list:[],categories:[],selectTable:[],params:{id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:20,idlessthan:0,sortby:1,sort:1},loadmore:!1,hasMore:!0,token:""}},watch:{status:function(){this.list=[],this.getProducts()}},created:function(){var t=this;this.token=Object(d["e"])(),this.getProducts(),Object(p["a"])("StoreCategoryService.GetCategoryList",Object(u["a"])("CategoryListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),ishidden:2,level:2,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{onClickAllItem:function(){this.$refs.table.toggleAllSelection()},onChangeCheckBox:function(t){this.$refs.table.toggleRowSelection(t)},clearFilter:function(){this.params={id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:100,idlessthan:0,sortby:1,sort:1},this.list=[],this.getProducts()},onSearch:function(){this.list=[],this.getProducts()},getProducts:function(){var t=this;this.loadmore=!0;var e=window,i=e.scrollY;this.params.isonline=0,this.params.hasquantity=0,this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,1===this.status&&(this.params.isonline=1),2===this.status&&(this.params.hasquantity=2),3===this.status&&(this.params.isonline=2),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",Object(c["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params))).then(function(e){t.list=t.list.concat(e.productlistList),t.hasMore=e.productlistList.length,0!==t.params.idlessthan&&window.scroll(0,i),t.loadmore=!1})},handleSelectionChange:function(t){this.selectTable=t},onEdit:function(t){this.$router.push({name:"products-edit",query:{id:t,type:"edit"}})},onClickRecommend:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.toptime=0===t.toptime?parseInt(Date.now()/1e3):0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)})},onOnline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品上架成功",type:"success"})})},onOffline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品下架成功",type:"success"})})},onBatchOffline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品下架成功",type:"success"})})},onBatchOnline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品上架成功",type:"success"})})},onBatchCategory:function(t){var e=this,i=this.selectTable.map(function(i){return i=JSON.parse(JSON.stringify(i)),i.categoryidlistList=[t],i.categoryid=t,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:e.token}),product:Object(u["a"])("Product",Object(c["a"])({},i,{optionsList:i.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:i.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:i.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(i).then(function(t){t.forEach(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)}),e.$message({message:"修改分类成功",type:"success"})})},minPrice:function(t){var e=0;if(0===t.withoption)return e=t.price,0!==t.discountprice&&(e=t.discountprice),0!==t.vipprice&&(e=t.vipprice),1===t.supportgroup&&(e=t.groupprice),e;var i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.price),a.price<e&&(e=a.price),0!==a.discountprice&&a.discountprice<e&&(e=a.discountprice),0!==a.vipprice&&a.vipprice<e&&(e=a.vipprice),1===t.supportgroup&&a.groupprice<e&&(e=a.groupprice)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e},minQuantity:function(t){if(2===t.withquantity)return null;if(0===t.withoption)return t.quantity;var e=0,i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.quantity),a.quantity<e&&(e=a.quantity)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e}}},f=m,h=(i("f591"),i("2877")),b=Object(h["a"])(f,r,a,!1,null,"00d7df01",null),v=b.exports,g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container fr-aic fr-jcsb"},[i("comp-tab",{attrs:{data:[{label:"售卖中",value:1},{label:"已售罄",value:2},{label:"仓库中",value:3}]},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}}),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.$router.push({name:"products-edit"})}}},[t._v("发布商品")])],1),i("div",{staticClass:"container"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"商品ID"}},[i("el-input",{attrs:{placeholder:"请输入商品ID"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1),i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),i("el-form-item",{attrs:{label:"商品编码"}},[i("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.params.number,callback:function(e){t.$set(t.params,"number",e)},expression:"params.number"}})],1),i("el-form-item",{attrs:{label:"请选择商品分组"}},[i("el-select",{attrs:{placeholder:"选择商品分组"},model:{value:t.params.categoryid,callback:function(e){t.$set(t.params,"categoryid",e)},expression:"params.categoryid"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name.slice(1).split("/")[0],value:t.id}})}))],1)],1),i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params,size:"mini"}},[i("el-form-item",{attrs:{label:"销量区间"}},[i("el-input",{attrs:{placeholder:"最低销量"},model:{value:t.params.salesvolumegreaterthan,callback:function(e){t.$set(t.params,"salesvolumegreaterthan",e)},expression:"params.salesvolumegreaterthan"}})],1),i("el-form-item",[t._v("-")]),i("el-form-item",[i("el-input",{attrs:{placeholder:"最高销量"},model:{value:t.params.salesvolumelessthan,callback:function(e){t.$set(t.params,"salesvolumelessthan",e)},expression:"params.salesvolumelessthan"}})],1)],1),i("el-button",{attrs:{size:"small"},on:{click:t.onSearch}},[t._v("筛选")]),i("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),i("div",{staticClass:"container"},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{align:"center","header-align":"center",type:"selection",width:"40px"}}),i("el-table-column",{attrs:{align:"center","header-align":"center",label:"ID",prop:"id",width:"80px"}}),i("el-table-column",{attrs:{label:"商品",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-info_img"},[i("comp-imger",{attrs:{src:e.row.imagesList.length?e.row.imagesList[0]:""}})],1),i("div",{staticClass:"order-info_base"},[i("div",[i("span",{staticStyle:{cursor:"pointer",color:"#5c92c5"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v(t._s(e.row.name))]),i("div",{staticClass:"color3",staticStyle:{"font-size":"14px"}},[t._v("¥ "+t._s(t.minPrice(e.row)/100))])])])])]}}])}),i("el-table-column",{attrs:{label:"总销量",prop:"salesvolume",sortable:""}}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(new Date(1e3*e.row.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n        ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v("编辑")]),1===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOffline(e.row)}}},[t._v("下架")]):t._e(),0===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOnline(e.row)}}},[t._v("上架")]):t._e()]}}])})],1),i("div",{staticClass:"table-bottom"},[i("div",{staticClass:"mutil-action"},[i("el-button",{attrs:{size:"small",type:"text"},on:{click:t.onClickAllItem}},[t._v("全选")]),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!t.selectTable.length,size:"small",type:"text"},on:{click:t.onBatchOffline}},[t._v("批量下架")]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.onBatchCategory}},[i("el-button",{attrs:{disabled:!t.selectTable.length,size:"small",type:"text"}},[t._v("\n            批量改分组\n            "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticStyle:{height:"200px",overflow:"auto"}},t._l(t.categories,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:""+e.id}},[t._v(t._s(e.name.slice(1).split("/")[0]))])}))])],1)],1),t.hasMore?i("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getProducts}},[t._v("加载更多")]):i("span",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1)],1)])},O=[],k={components:{"comp-tab":l["a"]},data:function(){return{status:1,list:[],categories:[],selectTable:[],params:{id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:20,idlessthan:0,sortby:1,sort:1},loadmore:!1,hasMore:!0,token:""}},watch:{status:function(){this.list=[],this.getProducts()}},created:function(){var t=this;this.token=Object(d["e"])(),this.getProducts(),Object(p["a"])("StoreCategoryService.GetCategoryList",Object(u["a"])("CategoryListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{onClickAllItem:function(){this.$refs.table.toggleAllSelection()},onChangeCheckBox:function(t){this.$refs.table.toggleRowSelection(t)},clearFilter:function(){this.params={id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:100,idlessthan:0,sortby:1,sort:1},this.list=[],this.getProducts()},onSearch:function(){this.list=[],this.getProducts()},getProducts:function(){var t=this;this.loadmore=!0;var e=window,i=e.scrollY;this.params.isonline=0,this.params.hasquantity=0,this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,1===this.status&&(this.params.isonline=1),2===this.status&&(this.params.hasquantity=2),3===this.status&&(this.params.isonline=2),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",Object(c["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params))).then(function(e){t.list=t.list.concat(e.productlistList),t.hasMore=e.productlistList.length,0!==t.params.idlessthan&&window.scroll(0,i),t.loadmore=!1})},handleSelectionChange:function(t){this.selectTable=t},onEdit:function(t){this.$router.push({name:"products-edit",query:{id:t,type:"edit"}})},onOnline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品上架成功",type:"success"})})},onOffline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品下架成功",type:"success"})})},onBatchOffline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品下架成功",type:"success"})})},onBatchOnline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品上架成功",type:"success"})})},onBatchCategory:function(t){var e=this,i=this.selectTable.map(function(i){return i=JSON.parse(JSON.stringify(i)),i.categoryidlistList=[t],i.categoryid=t,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:e.token}),product:Object(u["a"])("Product",Object(c["a"])({},i,{optionsList:i.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:i.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:i.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(i).then(function(t){t.forEach(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)}),e.$message({message:"修改分类成功",type:"success"})})},minPrice:function(t){var e=0;if(0===t.withoption)return e=t.price,0!==t.discountprice&&(e=t.discountprice),0!==t.vipprice&&(e=t.vipprice),1===t.supportgroup&&(e=t.groupprice),e;var i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.price),a.price<e&&(e=a.price),0!==a.discountprice&&a.discountprice<e&&(e=a.discountprice),0!==a.vipprice&&a.vipprice<e&&(e=a.vipprice),1===t.supportgroup&&a.groupprice<e&&(e=a.groupprice)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e},minQuantity:function(t){if(2===t.withquantity)return null;if(0===t.withoption)return t.quantity;var e=0,i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.quantity),a.quantity<e&&(e=a.quantity)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e}}},y=k,L=(i("debd"),Object(h["a"])(y,g,O,!1,null,"67e1c6f0",null)),j=L.exports,S=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container fr-aic fr-jcsb"},[i("comp-tab",{attrs:{data:[{label:"售卖中",value:1},{label:"已售罄",value:2},{label:"仓库中",value:3}]},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}}),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.$router.push({name:"products-edit"})}}},[t._v("发布商品")])],1),i("div",{staticClass:"container"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"商品ID"}},[i("el-input",{attrs:{placeholder:"请输入商品ID"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1),i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),i("el-form-item",{attrs:{label:"商品编码"}},[i("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.params.number,callback:function(e){t.$set(t.params,"number",e)},expression:"params.number"}})],1),i("el-form-item",{attrs:{label:"请选择商品分组"}},[i("el-select",{attrs:{placeholder:"选择商品分组"},model:{value:t.params.categoryid,callback:function(e){t.$set(t.params,"categoryid",e)},expression:"params.categoryid"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name.slice(1).split("/")[0]+" - "+t.name.slice(1).split("/")[1],value:t.id}})}))],1)],1),i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params,size:"mini"}},[i("el-form-item",{attrs:{label:"销量区间"}},[i("el-input",{attrs:{placeholder:"最低销量"},model:{value:t.params.salesvolumegreaterthan,callback:function(e){t.$set(t.params,"salesvolumegreaterthan",e)},expression:"params.salesvolumegreaterthan"}})],1),i("el-form-item",[t._v("-")]),i("el-form-item",[i("el-input",{attrs:{placeholder:"最高销量"},model:{value:t.params.salesvolumelessthan,callback:function(e){t.$set(t.params,"salesvolumelessthan",e)},expression:"params.salesvolumelessthan"}})],1)],1),i("el-button",{attrs:{size:"small"},on:{click:t.onSearch}},[t._v("筛选")]),i("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),i("div",{staticClass:"container"},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{staticClass:"table-column",attrs:{align:"center","header-align":"center",width:"46px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{attrs:{content:0!==e.row.toptime?"取消在首页展示该商品":"推荐该商品在首页展示(小程序显示:最后推荐的在最上面)",effect:"dark",placement:"top-start"}},[i("i",{class:["el-icon-star-on",{show:e.row.toptime>0}],style:{color:0!==e.row.toptime?"#e87b26":"grey"},on:{click:function(i){t.onClickRecommend(e.row)}}})])]}}])}),i("el-table-column",{attrs:{align:"center","header-align":"center",type:"selection",width:"40px"}}),i("el-table-column",{attrs:{align:"center","header-align":"center",label:"ID",prop:"id",width:"80px"}}),i("el-table-column",{attrs:{label:"商品",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-info_img"},[i("comp-imger",{attrs:{src:e.row.imagesList.length?e.row.imagesList[0]:""}})],1),i("div",{staticClass:"order-info_base"},[i("div",[i("span",{staticStyle:{cursor:"pointer",color:"#5c92c5"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v(t._s(e.row.name))]),i("div",{staticClass:"color3",staticStyle:{"font-size":"14px"}},[t._v("¥ "+t._s(t.minPrice(e.row)/100))])])])])]}}])}),i("el-table-column",{attrs:{label:"库存",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(null!==t.minQuantity(e.row)?t.minQuantity(e.row):"/")+"\n        ")]}}])}),i("el-table-column",{attrs:{label:"总销量",prop:"salesvolume",sortable:""}}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(new Date(1e3*e.row.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n        ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v("编辑")]),1===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOffline(e.row)}}},[t._v("下架")]):t._e(),0===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOnline(e.row)}}},[t._v("上架")]):t._e()]}}])})],1),i("div",{staticClass:"table-bottom"},[i("div",{staticClass:"mutil-action"},[i("el-button",{attrs:{size:"small",type:"text"},on:{click:t.onClickAllItem}},[t._v("全选")]),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!t.selectTable.length,size:"small",type:"text"},on:{click:t.onBatchOffline}},[t._v("批量下架")]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.onBatchCategory}},[i("el-button",{attrs:{disabled:!t.selectTable.length,size:"small",type:"text"}},[t._v("\n            批量改分组\n            "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticStyle:{height:"200px",overflow:"auto"}},t._l(t.categories,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:""+e.id}},[t._v(t._s(e.name.slice(1).split("/")[0]+" - "+e.name.slice(1).split("/")[1]))])}))])],1)],1),t.hasMore?i("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getProducts}},[t._v("加载更多")]):i("span",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1)],1)])},P=[],w={components:{"comp-tab":l["a"]},data:function(){return{status:1,list:[],categories:[],selectTable:[],params:{id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:20,idlessthan:0,sortby:1,sort:1},loadmore:!1,hasMore:!0,token:""}},watch:{status:function(){this.list=[],this.getProducts()}},created:function(){var t=this;this.token=Object(d["e"])(),this.getProducts(),Object(p["a"])("StoreCategoryService.GetCategoryList",Object(u["a"])("CategoryListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),ishidden:2,level:2,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{onClickAllItem:function(){this.$refs.table.toggleAllSelection()},onChangeCheckBox:function(t){this.$refs.table.toggleRowSelection(t)},clearFilter:function(){this.params={id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:100,idlessthan:0,sortby:1,sort:1},this.list=[],this.getProducts()},onSearch:function(){this.list=[],this.getProducts()},getProducts:function(){var t=this;this.loadmore=!0;var e=window,i=e.scrollY;this.params.isonline=0,this.params.hasquantity=0,this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,1===this.status&&(this.params.isonline=1),2===this.status&&(this.params.hasquantity=2),3===this.status&&(this.params.isonline=2),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",Object(c["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params))).then(function(e){t.list=t.list.concat(e.productlistList),t.hasMore=e.productlistList.length,0!==t.params.idlessthan&&window.scroll(0,i),t.loadmore=!1})},handleSelectionChange:function(t){this.selectTable=t},onEdit:function(t){this.$router.push({name:"products-edit",query:{id:t,type:"edit"}})},onClickRecommend:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.toptime=0===t.toptime?parseInt(Date.now()/1e3):0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)})},onOnline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品上架成功",type:"success"})})},onOffline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品下架成功",type:"success"})})},onBatchOffline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品下架成功",type:"success"})})},onBatchOnline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品上架成功",type:"success"})})},onBatchCategory:function(t){var e=this,i=this.selectTable.map(function(i){return i=JSON.parse(JSON.stringify(i)),i.categoryidlistList=[t],i.categoryid=t,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:e.token}),product:Object(u["a"])("Product",Object(c["a"])({},i,{optionsList:i.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:i.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:i.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(i).then(function(t){t.forEach(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)}),e.$message({message:"修改分类成功",type:"success"})})},minPrice:function(t){var e=0;if(0===t.withoption)return e=t.price,0!==t.discountprice&&(e=t.discountprice),0!==t.vipprice&&(e=t.vipprice),1===t.supportgroup&&(e=t.groupprice),e;var i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.price),a.price<e&&(e=a.price),0!==a.discountprice&&a.discountprice<e&&(e=a.discountprice),0!==a.vipprice&&a.vipprice<e&&(e=a.vipprice),1===t.supportgroup&&a.groupprice<e&&(e=a.groupprice)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e},minQuantity:function(t){if(2===t.withquantity)return null;if(0===t.withoption)return t.quantity;var e=0,i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.quantity),a.quantity<e&&(e=a.quantity)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e}}},_=w,x=(i("5fcd"),Object(h["a"])(_,S,P,!1,null,"4a32ca3f",null)),T=x.exports,C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container fr-aic fr-jcsb"},[i("comp-tab",{attrs:{data:[{label:"售卖中",value:1},{label:"已售罄",value:2},{label:"仓库中",value:3}]},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}}),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.$router.push({name:"products-edit"})}}},[t._v("发布商品")])],1),i("div",{staticClass:"container"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"商品ID"}},[i("el-input",{attrs:{placeholder:"请输入商品ID"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1),i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),i("el-form-item",{attrs:{label:"商品编码"}},[i("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.params.number,callback:function(e){t.$set(t.params,"number",e)},expression:"params.number"}})],1),i("el-form-item",{attrs:{label:"请选择商品分组"}},[i("el-select",{attrs:{placeholder:"选择商品分组"},model:{value:t.params.categoryid,callback:function(e){t.$set(t.params,"categoryid",e)},expression:"params.categoryid"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name.slice(1).split("/")[0],value:t.id}})}))],1)],1),i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params,size:"mini"}},[i("el-form-item",{attrs:{label:"销量区间"}},[i("el-input",{attrs:{placeholder:"最低销量"},model:{value:t.params.salesvolumegreaterthan,callback:function(e){t.$set(t.params,"salesvolumegreaterthan",e)},expression:"params.salesvolumegreaterthan"}})],1),i("el-form-item",[t._v("-")]),i("el-form-item",[i("el-input",{attrs:{placeholder:"最高销量"},model:{value:t.params.salesvolumelessthan,callback:function(e){t.$set(t.params,"salesvolumelessthan",e)},expression:"params.salesvolumelessthan"}})],1)],1),i("el-button",{attrs:{size:"small"},on:{click:t.onSearch}},[t._v("筛选")]),i("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),i("div",{staticClass:"container"},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{align:"center","header-align":"center",type:"selection",width:"40px"}}),i("el-table-column",{attrs:{align:"center","header-align":"center",label:"ID",prop:"id",width:"80px"}}),i("el-table-column",{attrs:{label:"商品",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-info_img"},[i("comp-imger",{attrs:{src:e.row.imagesList.length?e.row.imagesList[0]:""}})],1),i("div",{staticClass:"order-info_base"},[i("div",[i("span",{staticStyle:{cursor:"pointer",color:"#5c92c5"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v(t._s(e.row.name))]),i("div",{staticClass:"color3",staticStyle:{"font-size":"14px"}},[t._v("¥ "+t._s(t.minPrice(e.row)/100))])])])])]}}])}),i("el-table-column",{attrs:{label:"总销量",prop:"salesvolume",sortable:""}}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(new Date(1e3*e.row.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n        ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v("编辑")]),1===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOffline(e.row)}}},[t._v("下架")]):t._e(),0===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOnline(e.row)}}},[t._v("上架")]):t._e()]}}])})],1),i("div",{staticClass:"table-bottom"},[i("div",{staticClass:"mutil-action"},[i("el-button",{attrs:{size:"small",type:"text"},on:{click:t.onClickAllItem}},[t._v("全选")]),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!t.selectTable.length,size:"small",type:"text"},on:{click:t.onBatchOffline}},[t._v("批量下架")]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.onBatchCategory}},[i("el-button",{attrs:{disabled:!t.selectTable.length,size:"small",type:"text"}},[t._v("\n            批量改分组\n            "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticStyle:{height:"200px",overflow:"auto"}},t._l(t.categories,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:""+e.id}},[t._v(t._s(e.name.slice(1).split("/")[0]))])}))])],1)],1),t.hasMore?i("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getProducts}},[t._v("加载更多")]):i("span",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1)],1)])},N=[],$={components:{"comp-tab":l["a"]},data:function(){return{status:1,list:[],categories:[],selectTable:[],params:{id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:20,idlessthan:0,sortby:1,sort:1},loadmore:!1,hasMore:!0,token:""}},watch:{status:function(){this.list=[],this.getProducts()}},created:function(){var t=this;this.token=Object(d["e"])(),this.getProducts(),Object(p["a"])("StoreCategoryService.GetCategoryList",Object(u["a"])("CategoryListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{onClickAllItem:function(){this.$refs.table.toggleAllSelection()},onChangeCheckBox:function(t){this.$refs.table.toggleRowSelection(t)},clearFilter:function(){this.params={id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:100,idlessthan:0,sortby:1,sort:1},this.list=[],this.getProducts()},onSearch:function(){this.list=[],this.getProducts()},getProducts:function(){var t=this;this.loadmore=!0;var e=window,i=e.scrollY;this.params.isonline=0,this.params.hasquantity=0,this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,1===this.status&&(this.params.isonline=1),2===this.status&&(this.params.hasquantity=2),3===this.status&&(this.params.isonline=2),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",Object(c["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params))).then(function(e){t.list=t.list.concat(e.productlistList),t.hasMore=e.productlistList.length,0!==t.params.idlessthan&&window.scroll(0,i),t.loadmore=!1})},handleSelectionChange:function(t){this.selectTable=t},onEdit:function(t){this.$router.push({name:"products-edit",query:{id:t,type:"edit"}})},onOnline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品上架成功",type:"success"})})},onOffline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品下架成功",type:"success"})})},onBatchOffline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品下架成功",type:"success"})})},onBatchOnline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品上架成功",type:"success"})})},onBatchCategory:function(t){var e=this,i=this.selectTable.map(function(i){return i=JSON.parse(JSON.stringify(i)),i.categoryidlistList=[t],i.categoryid=t,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:e.token}),product:Object(u["a"])("Product",Object(c["a"])({},i,{optionsList:i.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:i.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:i.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(i).then(function(t){t.forEach(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)}),e.$message({message:"修改分类成功",type:"success"})})},minPrice:function(t){if(1===t.withtimeslot){var e=0;return e=t.price,0!==t.discountprice&&(e=t.discountprice),0!==t.vipprice&&(e=t.vipprice),1===t.supportgroup&&(e=t.groupprice),e}var i=null;t.producttimeslotlistList.forEach(function(t){t.producttimeslotpricelistList.forEach(function(t){null!==i?t.price<i.price&&(i=t):i=t})});e=i.price;return 0!==i.discountprice&&(e=i.discountprice),0!==i.vipprice&&(e=i.vipprice),1===i.supportgroup&&(e=i.groupprice),e},minQuantity:function(t){if(2===t.withquantity)return null;if(0===t.withoption)return t.quantity;var e=0,i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.quantity),a.quantity<e&&(e=a.quantity)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e}}},q=$,z=(i("b954"),Object(h["a"])(q,C,N,!1,null,"e79c3548",null)),I=z.exports,J=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container fr-aic fr-jcsb"},[i("comp-tab",{attrs:{data:[{label:"售卖中",value:1},{label:"已售罄",value:2},{label:"仓库中",value:3}]},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}}),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.$router.push({name:"products-edit"})}}},[t._v("发布商品")])],1),i("div",{staticClass:"container"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"商品ID"}},[i("el-input",{attrs:{placeholder:"请输入商品ID"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1),i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),i("el-form-item",{attrs:{label:"商品编码"}},[i("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.params.number,callback:function(e){t.$set(t.params,"number",e)},expression:"params.number"}})],1),i("el-form-item",{attrs:{label:"请选择商品分组"}},[i("el-select",{attrs:{placeholder:"选择商品分组"},model:{value:t.params.categoryid,callback:function(e){t.$set(t.params,"categoryid",e)},expression:"params.categoryid"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name.slice(1).split("/")[0]+" - "+t.name.slice(1).split("/")[1],value:t.id}})}))],1)],1),i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params,size:"mini"}},[i("el-form-item",{attrs:{label:"销量区间"}},[i("el-input",{attrs:{placeholder:"最低销量"},model:{value:t.params.salesvolumegreaterthan,callback:function(e){t.$set(t.params,"salesvolumegreaterthan",e)},expression:"params.salesvolumegreaterthan"}})],1),i("el-form-item",[t._v("-")]),i("el-form-item",[i("el-input",{attrs:{placeholder:"最高销量"},model:{value:t.params.salesvolumelessthan,callback:function(e){t.$set(t.params,"salesvolumelessthan",e)},expression:"params.salesvolumelessthan"}})],1)],1),i("el-button",{attrs:{size:"small"},on:{click:t.onSearch}},[t._v("筛选")]),i("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),i("div",{staticClass:"container"},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{staticClass:"table-column",attrs:{align:"center","header-align":"center",width:"46px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{attrs:{content:0!==e.row.toptime?"取消在首页展示该商品":"推荐该商品在首页展示(小程序显示:最后推荐的在最上面)",effect:"dark",placement:"top-start"}},[i("i",{class:["el-icon-star-on",{show:e.row.toptime>0}],style:{color:0!==e.row.toptime?"#e87b26":"grey"},on:{click:function(i){t.onClickRecommend(e.row)}}})])]}}])}),i("el-table-column",{attrs:{align:"center","header-align":"center",type:"selection",width:"40px"}}),i("el-table-column",{attrs:{align:"center","header-align":"center",label:"ID",prop:"id",width:"80px"}}),i("el-table-column",{attrs:{label:"商品",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-info_img"},[i("comp-imger",{attrs:{src:e.row.imagesList.length?e.row.imagesList[0]:""}})],1),i("div",{staticClass:"order-info_base"},[i("div",[i("span",{staticStyle:{cursor:"pointer",color:"#5c92c5"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v(t._s(e.row.name))]),i("div",{staticClass:"color3",staticStyle:{"font-size":"14px"}},[t._v("¥ "+t._s(t.minPrice(e.row)/100))])])])])]}}])}),i("el-table-column",{attrs:{label:"库存",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(null!==t.minQuantity(e.row)?t.minQuantity(e.row):"/")+"\n        ")]}}])}),i("el-table-column",{attrs:{label:"总销量",prop:"salesvolume",sortable:""}}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(new Date(1e3*e.row.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n        ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v("编辑")]),1===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOffline(e.row)}}},[t._v("下架")]):t._e(),0===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOnline(e.row)}}},[t._v("上架")]):t._e()]}}])})],1),i("div",{staticClass:"table-bottom"},[i("div",{staticClass:"mutil-action"},[i("el-button",{attrs:{size:"small",type:"text"},on:{click:t.onClickAllItem}},[t._v("全选")]),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!t.selectTable.length,size:"small",type:"text"},on:{click:t.onBatchOffline}},[t._v("批量下架")]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.onBatchCategory}},[i("el-button",{attrs:{disabled:!t.selectTable.length,size:"small",type:"text"}},[t._v("\n            批量改分组\n            "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticStyle:{height:"200px",overflow:"auto"}},t._l(t.categories,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:""+e.id}},[t._v(t._s(e.name.slice(1).split("/")[0]+" - "+e.name.slice(1).split("/")[1]))])}))])],1)],1),t.hasMore?i("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getProducts}},[t._v("加载更多")]):i("span",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1)],1)])},R=[],E={components:{"comp-tab":l["a"]},data:function(){return{status:1,list:[],categories:[],selectTable:[],params:{id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:20,idlessthan:0,sortby:1,sort:1},loadmore:!1,hasMore:!0,token:""}},watch:{status:function(){this.list=[],this.getProducts()}},created:function(){var t=this;this.token=Object(d["e"])(),this.getProducts(),Object(p["a"])("StoreCategoryService.GetCategoryList",Object(u["a"])("CategoryListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),ishidden:2,level:2,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{onClickAllItem:function(){this.$refs.table.toggleAllSelection()},onChangeCheckBox:function(t){this.$refs.table.toggleRowSelection(t)},clearFilter:function(){this.params={id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:100,idlessthan:0,sortby:1,sort:1},this.list=[],this.getProducts()},onSearch:function(){this.list=[],this.getProducts()},getProducts:function(){var t=this;this.loadmore=!0;var e=window,i=e.scrollY;this.params.isonline=0,this.params.hasquantity=0,this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,1===this.status&&(this.params.isonline=1),2===this.status&&(this.params.hasquantity=2),3===this.status&&(this.params.isonline=2),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",Object(c["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params))).then(function(e){t.list=t.list.concat(e.productlistList),t.hasMore=e.productlistList.length,0!==t.params.idlessthan&&window.scroll(0,i),t.loadmore=!1})},handleSelectionChange:function(t){this.selectTable=t},onEdit:function(t){this.$router.push({name:"products-edit",query:{id:t,type:"edit"}})},onClickRecommend:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.toptime=0===t.toptime?parseInt(Date.now()/1e3):0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)})},onOnline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品上架成功",type:"success"})})},onOffline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品下架成功",type:"success"})})},onBatchOffline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品下架成功",type:"success"})})},onBatchOnline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品上架成功",type:"success"})})},onBatchCategory:function(t){var e=this,i=this.selectTable.map(function(i){return i=JSON.parse(JSON.stringify(i)),i.categoryidlistList=[t],i.categoryid=t,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:e.token}),product:Object(u["a"])("Product",Object(c["a"])({},i,{optionsList:i.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:i.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:i.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(i).then(function(t){t.forEach(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)}),e.$message({message:"修改分类成功",type:"success"})})},minPrice:function(t){var e=0;if(0===t.withoption)return e=t.price,0!==t.discountprice&&(e=t.discountprice),0!==t.vipprice&&(e=t.vipprice),1===t.supportgroup&&(e=t.groupprice),e;var i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.price),a.price<e&&(e=a.price),0!==a.discountprice&&a.discountprice<e&&(e=a.discountprice),0!==a.vipprice&&a.vipprice<e&&(e=a.vipprice),1===t.supportgroup&&a.groupprice<e&&(e=a.groupprice)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e},minQuantity:function(t){if(2===t.withquantity)return null;if(0===t.withoption)return t.quantity;var e=0,i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.quantity),a.quantity<e&&(e=a.quantity)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e}}},B=E,U=(i("feb9"),Object(h["a"])(B,J,R,!1,null,"d8e49506",null)),W=U.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container fr-aic fr-jcsb"},[i("comp-tab",{attrs:{data:[{label:"售卖中",value:1},{label:"已售罄",value:2},{label:"仓库中",value:3}]},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}}),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.$router.push({name:"products-edit"})}}},[t._v("发布商品")])],1),i("div",{staticClass:"container"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"商品ID"}},[i("el-input",{attrs:{placeholder:"请输入商品ID"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1),i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),i("el-form-item",{attrs:{label:"商品编码"}},[i("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.params.number,callback:function(e){t.$set(t.params,"number",e)},expression:"params.number"}})],1),i("el-form-item",{attrs:{label:"请选择商品分组"}},[i("el-select",{attrs:{placeholder:"选择商品分组"},model:{value:t.params.categoryid,callback:function(e){t.$set(t.params,"categoryid",e)},expression:"params.categoryid"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name.slice(1).split("/")[0],value:t.id}})}))],1)],1),i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params,size:"mini"}},[i("el-form-item",{attrs:{label:"销量区间"}},[i("el-input",{attrs:{placeholder:"最低销量"},model:{value:t.params.salesvolumegreaterthan,callback:function(e){t.$set(t.params,"salesvolumegreaterthan",e)},expression:"params.salesvolumegreaterthan"}})],1),i("el-form-item",[t._v("-")]),i("el-form-item",[i("el-input",{attrs:{placeholder:"最高销量"},model:{value:t.params.salesvolumelessthan,callback:function(e){t.$set(t.params,"salesvolumelessthan",e)},expression:"params.salesvolumelessthan"}})],1)],1),i("el-button",{attrs:{size:"small"},on:{click:t.onSearch}},[t._v("筛选")]),i("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),i("div",{staticClass:"container"},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{align:"center","header-align":"center",type:"selection",width:"40px"}}),i("el-table-column",{attrs:{align:"center","header-align":"center",label:"ID",prop:"id",width:"80px"}}),i("el-table-column",{attrs:{label:"商品",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-info_img"},[i("comp-imger",{attrs:{src:e.row.imagesList.length?e.row.imagesList[0]:""}})],1),i("div",{staticClass:"order-info_base"},[i("div",[i("span",{staticStyle:{cursor:"pointer",color:"#5c92c5"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v(t._s(e.row.name))]),i("div",{staticClass:"color3",staticStyle:{"font-size":"14px"}},[t._v("¥ "+t._s(t.minPrice(e.row)/100))])])])])]}}])}),i("el-table-column",{attrs:{label:"库存",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(null!==t.minQuantity(e.row)?t.minQuantity(e.row):"/")+"\n        ")]}}])}),i("el-table-column",{attrs:{label:"总销量",prop:"salesvolume",sortable:""}}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(new Date(1e3*e.row.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n        ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v("编辑")]),1===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOffline(e.row)}}},[t._v("下架")]):t._e(),0===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOnline(e.row)}}},[t._v("上架")]):t._e()]}}])})],1),i("div",{staticClass:"table-bottom"},[i("div",{staticClass:"mutil-action"},[i("el-button",{attrs:{size:"small",type:"text"},on:{click:t.onClickAllItem}},[t._v("全选")]),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!t.selectTable.length,size:"small",type:"text"},on:{click:t.onBatchOffline}},[t._v("批量下架")]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.onBatchCategory}},[i("el-button",{attrs:{disabled:!t.selectTable.length,size:"small",type:"text"}},[t._v("\n            批量改分组\n            "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticStyle:{height:"200px",overflow:"auto"}},t._l(t.categories,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:""+e.id}},[t._v(t._s(e.name.slice(1).split("/")[0]))])}))])],1)],1),t.hasMore?i("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getProducts}},[t._v("加载更多")]):i("span",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1)],1)])},D=[],Q={components:{"comp-tab":l["a"]},data:function(){return{status:1,list:[],categories:[],selectTable:[],params:{id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:20,idlessthan:0,sortby:1,sort:1},loadmore:!1,hasMore:!0,token:""}},watch:{status:function(){this.list=[],this.getProducts()}},created:function(){var t=this;this.token=Object(d["e"])(),this.getProducts(),Object(p["a"])("StoreCategoryService.GetCategoryList",Object(u["a"])("CategoryListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{onClickAllItem:function(){this.$refs.table.toggleAllSelection()},onChangeCheckBox:function(t){this.$refs.table.toggleRowSelection(t)},clearFilter:function(){this.params={id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:100,idlessthan:0,sortby:1,sort:1},this.list=[],this.getProducts()},onSearch:function(){this.list=[],this.getProducts()},getProducts:function(){var t=this;this.loadmore=!0;var e=window,i=e.scrollY;this.params.isonline=0,this.params.hasquantity=0,this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,1===this.status&&(this.params.isonline=1),2===this.status&&(this.params.hasquantity=2),3===this.status&&(this.params.isonline=2),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",Object(c["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params))).then(function(e){t.list=t.list.concat(e.productlistList),t.hasMore=e.productlistList.length,0!==t.params.idlessthan&&window.scroll(0,i),t.loadmore=!1})},handleSelectionChange:function(t){this.selectTable=t},onEdit:function(t){this.$router.push({name:"products-edit",query:{id:t,type:"edit"}})},onOnline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品上架成功",type:"success"})})},onOffline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品下架成功",type:"success"})})},onBatchOffline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品下架成功",type:"success"})})},onBatchOnline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品上架成功",type:"success"})})},onBatchCategory:function(t){var e=this,i=this.selectTable.map(function(i){return i=JSON.parse(JSON.stringify(i)),i.categoryidlistList=[t],i.categoryid=t,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:e.token}),product:Object(u["a"])("Product",Object(c["a"])({},i,{optionsList:i.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:i.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:i.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(i).then(function(t){t.forEach(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)}),e.$message({message:"修改分类成功",type:"success"})})},minPrice:function(t){var e=0;if(0===t.withoption)return e=t.price,0!==t.discountprice&&(e=t.discountprice),0!==t.vipprice&&(e=t.vipprice),1===t.supportgroup&&(e=t.groupprice),e;var i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.price),a.price<e&&(e=a.price),0!==a.discountprice&&a.discountprice<e&&(e=a.discountprice),0!==a.vipprice&&a.vipprice<e&&(e=a.vipprice),1===t.supportgroup&&a.groupprice<e&&(e=a.groupprice)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e},minQuantity:function(t){if(2===t.withquantity)return null;if(0===t.withoption)return t.quantity;var e=0,i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.quantity),a.quantity<e&&(e=a.quantity)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e}}},M=Q,F=(i("a105"),Object(h["a"])(M,A,D,!1,null,"7241a18f",null)),G=F.exports,Y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container fr-aic fr-jcsb"},[i("comp-tab",{attrs:{data:[{label:"售卖中",value:1},{label:"已售罄",value:2},{label:"仓库中",value:3}]},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}}),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.$router.push({name:"products-edit"})}}},[t._v("发布商品")])],1),i("div",{staticClass:"container"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"商品ID"}},[i("el-input",{attrs:{placeholder:"请输入商品ID"},model:{value:t.params.id,callback:function(e){t.$set(t.params,"id",e)},expression:"params.id"}})],1),i("el-form-item",{attrs:{label:"商品名称"}},[i("el-input",{attrs:{placeholder:"请输入商品名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),i("el-form-item",{attrs:{label:"商品编码"}},[i("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.params.number,callback:function(e){t.$set(t.params,"number",e)},expression:"params.number"}})],1),i("el-form-item",{attrs:{label:"请选择商品分组"}},[i("el-select",{attrs:{placeholder:"选择商品分组"},model:{value:t.params.categoryid,callback:function(e){t.$set(t.params,"categoryid",e)},expression:"params.categoryid"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name.slice(1).split("/")[0],value:t.id}})}))],1)],1),i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params,size:"mini"}},[i("el-form-item",{attrs:{label:"销量区间"}},[i("el-input",{attrs:{placeholder:"最低销量"},model:{value:t.params.salesvolumegreaterthan,callback:function(e){t.$set(t.params,"salesvolumegreaterthan",e)},expression:"params.salesvolumegreaterthan"}})],1),i("el-form-item",[t._v("-")]),i("el-form-item",[i("el-input",{attrs:{placeholder:"最高销量"},model:{value:t.params.salesvolumelessthan,callback:function(e){t.$set(t.params,"salesvolumelessthan",e)},expression:"params.salesvolumelessthan"}})],1)],1),i("el-button",{attrs:{size:"small"},on:{click:t.onSearch}},[t._v("筛选")]),i("el-button",{staticStyle:{color:"#4E759E"},attrs:{size:"small",type:"text"},on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),i("div",{staticClass:"container"},[i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{align:"center","header-align":"center",type:"selection",width:"40px"}}),i("el-table-column",{attrs:{align:"center","header-align":"center",label:"ID",prop:"id",width:"80px"}}),i("el-table-column",{attrs:{label:"商品",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"order-info"},[i("div",{staticClass:"order-info_img"},[i("comp-imger",{attrs:{src:e.row.imagesList.length?e.row.imagesList[0]:""}})],1),i("div",{staticClass:"order-info_base"},[i("div",[i("span",{staticStyle:{cursor:"pointer",color:"#5c92c5"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v(t._s(e.row.name))]),i("div",{staticClass:"color3",staticStyle:{"font-size":"14px"}},[t._v("¥ "+t._s(t.minPrice(e.row)/100))])])])])]}}])}),i("el-table-column",{attrs:{label:"库存",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(null!==t.minQuantity(e.row)?t.minQuantity(e.row):"/")+"\n        ")]}}])}),i("el-table-column",{attrs:{label:"总销量",prop:"salesvolume",sortable:""}}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(new Date(1e3*e.row.createdat).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}))+"\n        ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onEdit(e.row.id)}}},[t._v("编辑")]),1===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOffline(e.row)}}},[t._v("下架")]):t._e(),0===e.row.online?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.onOnline(e.row)}}},[t._v("上架")]):t._e()]}}])})],1),i("div",{staticClass:"table-bottom"},[i("div",{staticClass:"mutil-action"},[i("el-button",{attrs:{size:"small",type:"text"},on:{click:t.onClickAllItem}},[t._v("全选")]),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!t.selectTable.length,size:"small",type:"text"},on:{click:t.onBatchOffline}},[t._v("批量下架")]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.onBatchCategory}},[i("el-button",{attrs:{disabled:!t.selectTable.length,size:"small",type:"text"}},[t._v("\n            批量改分组\n            "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticStyle:{height:"200px",overflow:"auto"}},t._l(t.categories,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:""+e.id}},[t._v(t._s(e.name.slice(1).split("/")[0]))])}))])],1)],1),t.hasMore?i("el-button",{attrs:{loading:t.loadmore,size:"small",type:"primary"},on:{click:t.getProducts}},[t._v("加载更多")]):i("span",{staticStyle:{color:"#ccc","font-size":"12px"}},[t._v("已加载全部，没有更多了")])],1)],1)])},Z=[],H={components:{"comp-tab":l["a"]},data:function(){return{status:1,list:[],categories:[],selectTable:[],params:{id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:20,idlessthan:0,sortby:1,sort:1},loadmore:!1,hasMore:!0,token:""}},watch:{status:function(){this.list=[],this.getProducts()}},created:function(){var t=this;this.token=Object(d["e"])(),this.getProducts(),Object(p["a"])("StoreCategoryService.GetCategoryList",Object(u["a"])("CategoryListQueryRequest",{token:Object(u["a"])("Token",{token:this.token}),ishidden:2,level:1,count:100,sortby:1})).then(function(e){t.categories=e.categorylistList})},methods:{onClickAllItem:function(){this.$refs.table.toggleAllSelection()},onChangeCheckBox:function(t){this.$refs.table.toggleRowSelection(t)},clearFilter:function(){this.params={id:"",name:"",number:"",categoryid:"",salesvolumegreaterthan:"",salesvolumelessthan:"",count:100,idlessthan:0,sortby:1,sort:1},this.list=[],this.getProducts()},onSearch:function(){this.list=[],this.getProducts()},getProducts:function(){var t=this;this.loadmore=!0;var e=window,i=e.scrollY;this.params.isonline=0,this.params.hasquantity=0,this.params.idlessthan=this.list.length?this.list[this.list.length-1].id:0,1===this.status&&(this.params.isonline=1),2===this.status&&(this.params.hasquantity=2),3===this.status&&(this.params.isonline=2),Object(p["a"])("StoreProductService.GetProductList",Object(u["a"])("ProductListQueryRequest",Object(c["a"])({token:Object(u["a"])("Token",{token:this.token})},this.params))).then(function(e){t.list=t.list.concat(e.productlistList),t.hasMore=e.productlistList.length,0!==t.params.idlessthan&&window.scroll(0,i),t.loadmore=!1})},handleSelectionChange:function(t){this.selectTable=t},onEdit:function(t){this.$router.push({name:"products-edit",query:{id:t,type:"edit"}})},onOnline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品上架成功",type:"success"})})},onOffline:function(t){var e=this;t=JSON.parse(JSON.stringify(t)),t.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:this.token}),product:Object(u["a"])("Product",Object(c["a"])({},t,{optionsList:t.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:t.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:t.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))})).then(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t),e.$message({message:"商品下架成功",type:"success"})})},onBatchOffline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=0,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品下架成功",type:"success"})})},onBatchOnline:function(){var t=this,e=this.selectTable.map(function(e){return e=JSON.parse(JSON.stringify(e)),e.online=1,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:t.token}),product:Object(u["a"])("Product",Object(c["a"])({},e,{optionsList:e.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:e.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:e.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(e).then(function(e){e.forEach(function(e){t.list.splice(t.list.findIndex(function(t){return t.id===e.id}),1,e)}),t.$message({message:"商品上架成功",type:"success"})})},onBatchCategory:function(t){var e=this,i=this.selectTable.map(function(i){return i=JSON.parse(JSON.stringify(i)),i.categoryidlistList=[t],i.categoryid=t,Object(p["a"])("StoreProductService.UpdateProduct",Object(u["a"])("ProductWithTokenRequest",{token:Object(u["a"])("Token",{token:e.token}),product:Object(u["a"])("Product",Object(c["a"])({},i,{optionsList:i.optionsList.map(function(t){return Object(u["a"])("Option",t)}),productnoticelistList:i.productnoticelistList.map(function(t){return Object(u["a"])("ProductNotice",t)}),producttimeslotlistList:i.producttimeslotlistList.map(function(t){return Object(u["a"])("ProductTimeSlot",{weeklistList:t.weeklistList,producttimeslotpricelistList:t.producttimeslotpricelistList.map(function(t){return Object(u["a"])("ProductTimeSlotPrice",t)})})})}))}))});Promise.all(i).then(function(t){t.forEach(function(t){e.list.splice(e.list.findIndex(function(e){return e.id===t.id}),1,t)}),e.$message({message:"修改分类成功",type:"success"})})},minPrice:function(t){var e=0;if(0===t.withoption)return e=t.price,0!==t.discountprice&&(e=t.discountprice),0!==t.vipprice&&(e=t.vipprice),1===t.supportgroup&&(e=t.groupprice),e;var i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.price),a.price<e&&(e=a.price),0!==a.discountprice&&a.discountprice<e&&(e=a.discountprice),0!==a.vipprice&&a.vipprice<e&&(e=a.vipprice),1===t.supportgroup&&a.groupprice<e&&(e=a.groupprice)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e},minQuantity:function(t){if(2===t.withquantity)return null;if(0===t.withoption)return t.quantity;var e=0,i=!0,s=!1,o=void 0;try{for(var n,r=t.optionsList[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var a=n.value;0===e&&(e=a.quantity),a.quantity<e&&(e=a.quantity)}}catch(c){s=!0,o=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return e}}},K=H,V=(i("fb48"),Object(h["a"])(K,Y,Z,!1,null,"53d9c450",null)),X=V.exports,tt={_0:v,_1:j,_2:T,_3:I,_4:W,_6:G,_7:X},et={0:"_0",1:"_1",2:"_2",3:"_3",4:"_4",6:"_6",7:"_7"},it=Object(n["a"])({name:"products-list-entry",components:tt,map:et}),st=it,ot=Object(h["a"])(st,s,o,!1,null,null,null);e["default"]=ot.exports},debd:function(t,e,i){"use strict";var s=i("6040"),o=i.n(s);o.a},f591:function(t,e,i){"use strict";var s=i("26d3"),o=i.n(s);o.a},f882:function(t,e,i){},fb48:function(t,e,i){"use strict";var s=i("1733"),o=i.n(s);o.a},feb9:function(t,e,i){"use strict";var s=i("5583"),o=i.n(s);o.a}}]);
//# sourceMappingURL=products-list.ffc495ee.js.map